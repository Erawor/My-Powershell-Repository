<?xml version="1.0" encoding="utf-8"?>
<CodeSnippets>
  <Code Content="&#xD;&#xA;[reflection.assembly]::LoadWithPartialName(&quot;Microsoft.UpdateServices.Administration&quot;) | out-null&#xD;&#xA;if (!$wsus) {&#xD;&#xA;        $wsus = [Microsoft.UpdateServices.Administration.AdminProxy]::GetUpdateServer();&#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;$ds = new-object System.DirectoryServices.DirectorySearcher;&#xD;&#xA;$ds.Filter = &quot;(OU=*)&quot;;&#xD;&#xA;$ds.SearchScope = [System.DirectoryServices.SearchScope]::OneLevel;&#xD;&#xA;&#xD;&#xA;$parentGroup = $wsus.GetComputerTargetGroup([Microsoft.UpdateServices.Administration.ComputerTargetGroupId]::AllComputers);&#xD;&#xA;&#xD;&#xA;function EnumerateAD {&#xD;&#xA;     param($searchRoot);&#xD;&#xA;     $newGroup = $searchRoot.Name;&#xD;&#xA;&#xD;&#xA;     &quot;Creating $newGroup&quot;;&#xD;&#xA;     $parentGroup = $wsus.CreateComputerTargetGroup($newGroup, $parentGroup);&#xD;&#xA;&#xD;&#xA;     $ds.SearchRoot = $searchRoot;&#xD;&#xA;     $ds.FindAll() | foreach-object {&#xD;&#xA;           $de = $_.GetDirectoryEntry();&#xD;&#xA;           EnumerateAD($de);&#xD;&#xA;     }&#xD;&#xA;}&#xD;&#xA;EnumerateAD($ds.SearchRoot);&#xD;&#xA;" />
</CodeSnippets>