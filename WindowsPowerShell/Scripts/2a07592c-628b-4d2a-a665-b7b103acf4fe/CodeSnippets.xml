<?xml version="1.0" encoding="utf-8"?>
<CodeSnippets>
  <Code Content="add-PSSnapin quest.activeroles.admanagement&#xD;&#xA;$OnlineServers = @()&#xD;&#xA;&#xD;&#xA;Get-QADComputer -SearchRoot 'domain.com/ServerOU'  -OSName &quot;Windows*Server*&quot; | Sort Name | %{&#xD;&#xA;  &#xD;&#xA;  $PingResult = Get-WmiObject -Query &quot;SELECT * FROM win32_PingStatus WHERE address='$($_.Name)'&quot;&#xD;&#xA;  &#xD;&#xA;  If ($PingResult.StatusCode -eq 0) &#xD;&#xA;  {&#xD;&#xA;     # Add the current name to the array&#xD;&#xA;    $OnlineServers += &quot;$($_.Name)&quot;&#xD;&#xA;  }&#xD;&#xA;}&#xD;&#xA;Write-Host &quot;The following servers are set as Manual for WSUS:&quot;&#xD;&#xA;Write-Host &quot; &quot;&#xD;&#xA;foreach ($Server in $OnlineServers )&#xD;&#xA;{&#xD;&#xA;&#xD;&#xA; &#x9;&#x9;$key = “SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Auto Update”&#xD;&#xA;&#x9;&#x9;$keytype = [Microsoft.Win32.RegistryHive]::LocalMachine&#xD;&#xA;&#x9;&#x9;$RemoteBase = [Microsoft.Win32.RegistryKey]::OpenRemoteBaseKey($keytype,$Server)&#xD;&#xA;&#x9;&#x9;$regKey = $RemoteBase.OpenSubKey($key)&#xD;&#xA;&#x9;&#x9;$KeyValue = $regkey.GetValue(”AUOptions”)&#xD;&#xA;&#x9;&#x9;# No Manual. 4 = Auto download and scheduled installation&#xD;&#xA;&#x9;&#x9;if ($KeyValue -ne &quot;4&quot;) &#xD;&#xA;&#x9;&#x9;{ &#xD;&#xA;&#x9;&#x9;&#x9;# It will show servers set as Manual&#xD;&#xA;&#x9;&#x9;&#x9;Write-Host $Server&#xD;&#xA;&#x9;&#x9;}&#xD;&#xA;&#x9;}&#xD;&#xA;&#x9;" />
</CodeSnippets>