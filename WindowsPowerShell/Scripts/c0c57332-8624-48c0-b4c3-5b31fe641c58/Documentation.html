<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head>
        <title>Search for a string in all tables of SQL Server Database</title>        
        <meta name="description" content="To search the whole database for a string in the tables. This stored procedure will return the tables and result set with the matching search string.

" />
        <link href="https://i1.code.msdn.s-msft.com/RequestReduceContent/c82dc8ab865be0fb7316b2e09ac97654-bafb67d64bd55a2b1fd123070a82b424-RequestReducedStyle.css" rel="Stylesheet" type="text/css" />        
        <script src="https://ajax.aspnetcdn.com/ajax/jquery/jquery-1.6.1.min.js" type="text/javascript" ></script>
        <script src="https://i1.code.msdn.s-msft.com/RequestReduceContent/a12c72272a8fe142a00d8aae0ff5525e-cf9957f54e208c66abb738158989dd84-RequestReducedScript.js" type="text/javascript" ></script>                        <script type="text/javascript">
            function initializePage() {
                var activeTabData = 'activeTab';
                var otherTabClass = 'otherTab';
                var hiddenPreClass = 'hidden';
                $("a[href^=#]").attr("target","_self");
                $("div.scriptcode").each(function (i) {
                    var scriptBlock = $(this);
                    scriptBlock.trackCopy(trackCodeSnippetCodeDownload);
                    var labelElems = scriptBlock.find("div.title > span");
                    if (labelElems.length == 0) {
                        labelElems = scriptBlock.find("div.title");
                    }
                    var languageSpans = scriptBlock.find("span.hidden");
                    var pres = scriptBlock.find("pre");
                    if (languageSpans.length > 0 && pres.length > 1) {
                        labelElems.each(function(index, elem) {
                            var codePre = $(pres[index]);
                            var labelSpan = $(elem);
                            var languageSpan = $(languageSpans[index]);
                            labelSpan.data('code', codePre.text().replace(/(\r(\n)?)|((\r)?\n)/ig, '\r\n'));
                            codePre.removeClass(hiddenPreClass);  
                            codePre.addClass(languageSpan.text().replace(/^\s+|\s+$/g,""));
                            codePre.chili();
                            languageSpan.remove();
                        });

                        pres = scriptBlock.find("pre");
                        labelElems.each(function(index, elem) {
                            var codePre = $(pres[index]);
                            var labelSpan = $(elem);
                            if (index == 0) {
                                scriptBlock.data(activeTabData, 0);
                            }
                            else {
                                labelSpan.addClass(otherTabClass);
                                codePre.addClass(hiddenPreClass);  
                            }
                            labelSpan.click(function (e) {
                                var activeTab = scriptBlock.data(activeTabData);
                                $(labelElems[activeTab]).addClass(otherTabClass);   
                                $(pres[activeTab]).addClass(hiddenPreClass);   
                                        
                                codePre.removeClass(hiddenPreClass);    
                                labelSpan.removeClass(otherTabClass);
                                scriptBlock.data(activeTabData, index);

                                if( window.parent.Galleries ) {
                                    window.parent.Galleries.project.resizeDesc();
                                }
                            });
                        });

                        var preview = scriptBlock.find('div.preview');
                        if (preview.length == 0) {
                            preview = $(pres[pres.length - 1]);
                        }
                        preview.remove();

                        if (window.clipboardData && clipboardData.setData) {
                            var copyLink = $("<a href='#' class='copyCode'>Copy code</a>");
                            copyLink.click(function (e) {
                                trackCodeSnippetCodeDownload();
                                clipboardData.setData("Text", $(labelElems[scriptBlock.data(activeTabData)]).data('code'));
                                return false;
                            });
                            $(this).prepend(copyLink);
                        }
                    }
                });

                if ((window.parent) && (window.parent.Galleries)) {
                    window.parent.Galleries.project.resizeDesc();
                }

                    if (top.location == self.location) {
                         window.location.replace(window.location.href.replace('/description', ''));
                    }
            }

            function trackCodeSnippetCodeDownload() {
                if ((window.parent) && (window.parent.gTracker)) {
                    window.parent.gTracker.createActionEvent('Description', 'Download', 'Copy', 'CodeSnippet', null);
                }
            }
            
            function overrideAnchorLinksForFirefoxAndChrome(iframeId) {
                if(($.browser.mozilla && parseInt($.browser.version, 10) >= 2) || $.browser.webkit) {
                    var iframeOffset = $("#" + iframeId, window.parent.document).offset();
                    $("a").each(function () {
                        var link = $(this);
                        var href = link.attr("href");
                        if (href && href[0] == "#") {
                            var name = href.substring(1);
                            $(this).click(function () {
                                var nameElement = $("[name='" + name + "']");
                                var idElement = $("#" + name);
                                var element = null;
                                if (nameElement.length > 0) {
                                    element = nameElement;
                                } else if (idElement.length > 0) {
                                    element = idElement;
                                }

                                if (element) {
                                    var offset = element.offset();
                                    window.parent.scrollTo(offset.left, offset.top + iframeOffset.top);
                                }

                                return false;
                            });
                        }
                    });
                }
            }

            $(window).load(function(){
                initializePage();
                overrideAnchorLinksForFirefoxAndChrome("longdescIframe");

            });

        </script>
        <base target="_parent" />
    </head>
    <body>
        <div id="longDesc">
            
<h2>Description</h2>
<p><strong>Description</strong></p>
<p><em>This is a simple stored procedure which can search through all the data in the SQL Server database tables. Also this has capability to search in the selected tables if the table names are specified with comma separated values. This has a capability to
 generate the SQL alone without executing the SQL. Enclosing the script version of it also.</em></p>
<p><span style="color:#0000ff"><strong><em>A NewVersion is updated with the capabaility of
<strong><em>multiple comma seperated search string and&nbsp;</em></strong>searching multiple table names comma seperated with wild card.&nbsp;</em></strong></span></p>
<p><strong><em><span style="text-decoration:underline">Parameters and usage</span></em></strong></p>
<p><strong><em>@Tablenames</em></strong><em> -- Provide a single table name or multiple table name with comma seperated.</em></p>
<p><em>If left blank , it will check for all the tables in the database</em></p>
<p><em>Provide wild card tables names with comma seperated<span> </span></em></p>
<p><em>EX :'%tbl%,Dim%' -- This will search the table having names comtains &quot;tbl&quot; and starts with &quot;Dim&quot;<br>
</em></p>
<p><strong><em>@SearchStr</em></strong><em> -- Provide the search string. Use the '%' to coin the search.Also can provide multiple search with comma seperated</em></p>
<p><em>EX : X%--- will give data staring with X</em></p>
<p><em>%X--- will give data ending with X</em></p>
<p><em>%X%--- will give data containig X</em></p>
<p><em>%X%,Y%--- will give data containig &nbsp;X or starting with Y<span> </span>
</em></p>
<p><em>%X%,%,,% -- Use a double comma to search comma in the data<br>
</em></p>
<p><strong><em>@GenerateSQLOnly</em></strong><em> -- Provide 1 if you only want to generate the SQL statements without seraching the database.</em></p>
<p><em>By default it is 0 and it will search.</em></p>
<p><strong><em>Samples</em></strong><em> :</em></p>
<p><em>1. To search data in a table</em></p>
<p><em>EXEC SearchTables @Tablenames = 'T1'</em></p>
<p><em>,@SearchStr = '%TEST%'</em></p>
<p><em>The above sample searches in table T1 with string containing TEST.</em></p>
<p><em>2. To search in a multiple table</em></p>
<p><em>EXEC SearchTables @Tablenames = 'T2'</em></p>
<p><em>,@SearchStr = '%TEST%'</em></p>
<p><em>The above sample searches in tables T1 &amp; T2 with string containing TEST.</em></p>
<p><em>&nbsp;</em></p>
<p><em>3. To search in a all table</em></p>
<p><em>EXEC SearchTables @Tablenames = '%'</em></p>
<p><em>,@SearchStr = '%TEST%'</em></p>
<p><em>The above sample searches in all table with string containing TEST.</em></p>
<p><em>4. Generate the SQL for the Select statements</em></p>
<p><em>EXEC SearchTables @Tablenames = 'T1'</em></p>
<p><em>,@SearchStr = '%TEST%'</em></p>
<p><em>,@GenerateSQLOnly = 1</em></p>
<p><em>5. To Search in tables with specfic name<br>
EXEC SP_SearchTables @Tablenames<span> </span>= '%T1%'<span> </span>,@SearchStr<span>
</span>= '%TEST%'<span> </span>,@GenerateSQLOnly<span> </span>= 0<br>
6. To Search in multiple tables with specfic names<br>
EXEC SP_SearchTables @Tablenames<span> </span>= '%T1%,Dim%'<span> </span>,@SearchStr<span>
</span>= '%TEST%'<span> </span>,@GenerateSQLOnly<span> </span>= 0<span> </span>7. To specify multiple search strings<br>
EXEC SP_SearchTables @Tablenames<span> </span>= '%T1%,Dim%'<span> </span>,@SearchStr<span>
</span>= '%TEST%,TEST1%,%TEST2'<span> </span>,@GenerateSQLOnly<span> </span>= 0<br>
<br>
8. To search comma itself in the tables use double comma &quot;,,&quot;<br>
EXEC SP_SearchTables @Tablenames<span> </span>= '%T1%,Dim%'<span> </span>,@SearchStr<span>
</span>= '%,,%'<span> </span>,@GenerateSQLOnly<span> </span>= 0<br>
EXEC SP_SearchTables @Tablenames<span> </span>= '%T1%,Dim%'<span> </span>,@SearchStr<span>
</span>= '%with,,comma%'<span> </span>,@GenerateSQLOnly<span> </span>= 0<br>
</em></p>
<h2>Script</h2>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>SQL</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">mysql</span>
<pre class="hidden">IF OBJECT_ID('SP_SearchTables','P') IS NOT NULL
	DROP PROCEDURE SP_SearchTables
GO
CREATE PROCEDURE SP_SearchTables
 @Tablenames VARCHAR(500)
,@SearchStr NVARCHAR(60)
,@GenerateSQLOnly Bit = 0
AS

/*
	Parameters and usage

	@Tablenames		-- Provide a single table name or multiple table name with comma seperated. 
						If left blank , it will check for all the tables in the database
						Provide wild card tables names with comma seperated
						EX :'%tbl%,Dim%' -- This will search the table having names comtains &quot;tbl&quot; and starts with &quot;Dim&quot;
							
	@SearchStr		-- Provide the search string. Use the '%' to coin the search. Also can provide multiple search with comma seperated
						EX : X%--- will give data staring with X
							 %X--- will give data ending with X
							 %X%--- will give data containig  X
							 %X%,Y%--- will give data containig  X or starting with Y
							 %X%,%,,% -- Use a double comma to search comma in the data
	@GenerateSQLOnly -- Provide 1 if you only want to generate the SQL statements without seraching the database. 
						By default it is 0 and it will search.

	Samples :

	1. To search data in a table

		EXEC SP_SearchTables @Tablenames = 'T1'
						 ,@SearchStr  = '%TEST%'

		The above sample searches in table T1 with string containing TEST.

	2. To search in a multiple table

		EXEC SP_SearchTables @Tablenames = 'T2'
						 ,@SearchStr  = '%TEST%'

		The above sample searches in tables T1 &amp; T2 with string containing TEST.
	
	3. To search in a all table

		EXEC SP_SearchTables @Tablenames = '%'
						 ,@SearchStr  = '%TEST%'

		The above sample searches in all table with string containing TEST.

	4. Generate the SQL for the Select statements

		EXEC SP_SearchTables @Tablenames		= 'T1'
						 ,@SearchStr		= '%TEST%'
						 ,@GenerateSQLOnly	= 1

	5. To Search in tables with specfic name

		EXEC SP_SearchTables @Tablenames		= '%T1%'
						 ,@SearchStr		= '%TEST%'
						 ,@GenerateSQLOnly	= 0

	6. To Search in multiple tables with specfic names

		EXEC SP_SearchTables @Tablenames		= '%T1%,Dim%'
						 ,@SearchStr		= '%TEST%'
						 ,@GenerateSQLOnly	= 0
	
	7. To specify multiple search strings

		EXEC SP_SearchTables @Tablenames		= '%T1%,Dim%'
						 ,@SearchStr		= '%TEST%,TEST1%,%TEST2'
						 ,@GenerateSQLOnly	= 0


	8. To search comma itself in the tables use double comma &quot;,,&quot;

		EXEC SP_SearchTables @Tablenames		= '%T1%,Dim%'
						 ,@SearchStr		= '%,,%'
						 ,@GenerateSQLOnly	= 0

		EXEC SP_SearchTables @Tablenames		= '%T1%,Dim%'
						 ,@SearchStr		= '%with,,comma%'
						 ,@GenerateSQLOnly	= 0
*/

	SET NOCOUNT ON

	DECLARE @MatchFound BIT

	SELECT @MatchFound = 0

	DECLARE @CheckTableNames Table
	(
	Tablename sysname
	)

	DECLARE @SearchStringTbl TABLE
	(
	SearchString VARCHAR(500)
	)

	DECLARE @SQLTbl TABLE
	(
	 Tablename		SYSNAME
	,WHEREClause    VARCHAR(MAX)
	,SQLStatement   VARCHAR(MAX)
	,Execstatus		BIT 
	)

	DECLARE @SQL VARCHAR(MAX)
	DECLARE @TblSQL VARCHAR(MAX)
	DECLARE @tmpTblname sysname
	DECLARE @ErrMsg VARCHAR(100)

	IF LTRIM(RTRIM(@Tablenames)) IN ('' ,'%')
	BEGIN

		INSERT INTO @CheckTableNames
		SELECT Name
		  FROM sys.tables
	END
	ELSE
	BEGIN

		IF CHARINDEX(',',@Tablenames) &gt; 0 
			SELECT @SQL = 'SELECT ''' &#43; REPLACE(@Tablenames,',','''as TblName UNION SELECT ''') &#43; ''''
		ELSE
			SELECT @SQL = 'SELECT ''' &#43; @Tablenames &#43; ''' as TblName '

		SELECT @TblSQL = 'SELECT T.NAME
							FROM SYS.TABLES T
							JOIN (' &#43; @SQL &#43; ') tblsrc
							 ON T.name LIKE tblsrc.tblname '


		

		INSERT INTO @CheckTableNames
		EXEC(@TblSQL)

	END
	
	IF NOT EXISTS(SELECT 1 FROM @CheckTableNames)
	BEGIN
		
		SELECT @ErrMsg = 'No tables are found in this database ' &#43; DB_NAME() &#43; ' for the specified filter'
		PRINT @ErrMsg
		RETURN

	END


	IF LTRIM(RTRIM(@SearchStr)) =''
	BEGIN

		SELECT @ErrMsg = 'Please specify the search string in @SearchStr Parameter'
		PRINT @ErrMsg
		RETURN
	END
	ELSE
	BEGIN 
		SELECT @SearchStr = REPLACE(@SearchStr,',,,',',#DOUBLECOMMA#')
		SELECT @SearchStr = REPLACE(@SearchStr,',,','#DOUBLECOMMA#')

		SELECT @SQL = 'SELECT ''' &#43; REPLACE(@SearchStr,',','''as SearchString UNION SELECT ''') &#43; ''''

		INSERT INTO @SearchStringTbl
		(SearchString)
		EXEC(@SQL)

		UPDATE @SearchStringTbl
		   SET SearchString = REPLACE(SearchString ,'#DOUBLECOMMA#',',')
	END

	
	
	INSERT INTO @SQLTbl
	( Tablename,WHEREClause)
	SELECT QUOTENAME(SCh.name) &#43; '.' &#43; QUOTENAME(ST.NAME),
			(
				SELECT '[' &#43; SC.Name &#43; ']' &#43; ' LIKE ''' &#43; SearchSTR.SearchString &#43; ''' OR ' &#43; CHAR(10)
				  FROM SYS.columns SC
				  JOIN SYS.types STy
					ON STy.system_type_id = SC.system_type_id
				   AND STy.user_type_id =SC.user_type_id
				  CROSS JOIN @SearchStringTbl SearchSTR
				 WHERE STY.name in ('varchar','char','nvarchar','nchar','text')
				   AND SC.object_id = ST.object_id
				 ORDER BY SC.name
				FOR XML PATH('')
			)
	  FROM  SYS.tables ST
	  JOIN @CheckTableNames chktbls
				ON chktbls.Tablename = ST.name 
	  JOIN SYS.schemas SCh
	    ON ST.schema_id = SCh.schema_id
	 WHERE ST.name &lt;&gt; 'SearchTMP'
      GROUP BY ST.object_id, QUOTENAME(SCh.name) &#43; '.' &#43;  QUOTENAME(ST.NAME) ;
	

	  UPDATE @SQLTbl
		 SET SQLStatement = 'SELECT * INTO SearchTMP FROM ' &#43; Tablename &#43; ' WHERE ' &#43; substring(WHEREClause,1,len(WHEREClause)-5)


		 
	  DELETE FROM @SQLTbl
	   WHERE WHEREClause IS NULL
	
	WHILE EXISTS (SELECT 1 FROM @SQLTbl WHERE ISNULL(Execstatus ,0) = 0)
	BEGIN

		SELECT TOP 1 @tmpTblname = Tablename , @SQL = SQLStatement
		  FROM @SQLTbl 
		 WHERE ISNULL(Execstatus ,0) = 0

		 IF @GenerateSQLOnly = 0
		 BEGIN

			IF OBJECT_ID('SearchTMP','U') IS NOT NULL
				DROP TABLE SearchTMP
				
			EXEC (@SQL)

			IF EXISTS(SELECT 1 FROM SearchTMP)
			BEGIN
				SELECT Tablename=@tmpTblname,* FROM SearchTMP
				SELECT @MatchFound = 1
			END

		 END
		 ELSE
		 BEGIN
			 PRINT REPLICATE('-',100)
			 PRINT @tmpTblname
			 PRINT REPLICATE('-',100)
			 PRINT replace(@SQL,'INTO SearchTMP','')
		 END

		 UPDATE @SQLTbl
		    SET Execstatus = 1
		  WHERE Tablename = @tmpTblname

	END

	IF @MatchFound = 0 
	BEGIN
		SELECT @ErrMsg = 'No Matches are found in this database ' &#43; DB_NAME() &#43; ' for the specified filter'
		PRINT @ErrMsg
		RETURN
	END
	
	SET NOCOUNT OFF

go


</pre>
<div class="preview">
<pre class="mysql"><span class="sql__keyword">IF</span>&nbsp;<span class="sql__id">OBJECT_ID</span>(<span class="sql__string">'SP_SearchTables'</span>,<span class="sql__string">'P'</span>)&nbsp;<span class="sql__keyword">IS</span>&nbsp;<span class="sql__keyword">NOT</span>&nbsp;<span class="sql__value">NULL</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">DROP</span>&nbsp;<span class="sql__keyword">PROCEDURE</span>&nbsp;<span class="sql__id">SP_SearchTables</span>&nbsp;
<span class="sql__id">GO</span>&nbsp;
<span class="sql__keyword">CREATE</span>&nbsp;<span class="sql__keyword">PROCEDURE</span>&nbsp;<span class="sql__id">SP_SearchTables</span>&nbsp;
&nbsp;<span class="sql__keyword">@</span><span class="sql__variable">Tablenames</span>&nbsp;<span class="sql__keyword">VARCHAR</span>(<span class="sql__number">500</span>)&nbsp;
,<span class="sql__keyword">@</span><span class="sql__variable">SearchStr</span>&nbsp;<span class="sql__keyword">NVARCHAR</span>(<span class="sql__number">60</span>)&nbsp;
,<span class="sql__keyword">@</span><span class="sql__variable">GenerateSQLOnly</span>&nbsp;<span class="sql__keyword">Bit</span>&nbsp;=&nbsp;<span class="sql__number">0</span>&nbsp;
<span class="sql__keyword">AS</span>&nbsp;
&nbsp;
<span class="sql__mlcom">/*&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;Parameters&nbsp;and&nbsp;usage&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;@Tablenames&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;Provide&nbsp;a&nbsp;single&nbsp;table&nbsp;name&nbsp;or&nbsp;multiple&nbsp;table&nbsp;name&nbsp;with&nbsp;comma&nbsp;seperated.&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;left&nbsp;blank&nbsp;,&nbsp;it&nbsp;will&nbsp;check&nbsp;for&nbsp;all&nbsp;the&nbsp;tables&nbsp;in&nbsp;the&nbsp;database&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Provide&nbsp;wild&nbsp;card&nbsp;tables&nbsp;names&nbsp;with&nbsp;comma&nbsp;seperated&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX&nbsp;:'%tbl%,Dim%'&nbsp;--&nbsp;This&nbsp;will&nbsp;search&nbsp;the&nbsp;table&nbsp;having&nbsp;names&nbsp;comtains&nbsp;&quot;tbl&quot;&nbsp;and&nbsp;starts&nbsp;with&nbsp;&quot;Dim&quot;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;@SearchStr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;Provide&nbsp;the&nbsp;search&nbsp;string.&nbsp;Use&nbsp;the&nbsp;'%'&nbsp;to&nbsp;coin&nbsp;the&nbsp;search.&nbsp;Also&nbsp;can&nbsp;provide&nbsp;multiple&nbsp;search&nbsp;with&nbsp;comma&nbsp;seperated&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EX&nbsp;:&nbsp;X%---&nbsp;will&nbsp;give&nbsp;data&nbsp;staring&nbsp;with&nbsp;X&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%X---&nbsp;will&nbsp;give&nbsp;data&nbsp;ending&nbsp;with&nbsp;X&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%X%---&nbsp;will&nbsp;give&nbsp;data&nbsp;containig&nbsp;&nbsp;X&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%X%,Y%---&nbsp;will&nbsp;give&nbsp;data&nbsp;containig&nbsp;&nbsp;X&nbsp;or&nbsp;starting&nbsp;with&nbsp;Y&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%X%,%,,%&nbsp;--&nbsp;Use&nbsp;a&nbsp;double&nbsp;comma&nbsp;to&nbsp;search&nbsp;comma&nbsp;in&nbsp;the&nbsp;data&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;@GenerateSQLOnly&nbsp;--&nbsp;Provide&nbsp;1&nbsp;if&nbsp;you&nbsp;only&nbsp;want&nbsp;to&nbsp;generate&nbsp;the&nbsp;SQL&nbsp;statements&nbsp;without&nbsp;seraching&nbsp;the&nbsp;database.&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;By&nbsp;default&nbsp;it&nbsp;is&nbsp;0&nbsp;and&nbsp;it&nbsp;will&nbsp;search.&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;Samples&nbsp;:&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;1.&nbsp;To&nbsp;search&nbsp;data&nbsp;in&nbsp;a&nbsp;table&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXEC&nbsp;SP_SearchTables&nbsp;@Tablenames&nbsp;=&nbsp;'T1'&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,@SearchStr&nbsp;&nbsp;=&nbsp;'%TEST%'&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;above&nbsp;sample&nbsp;searches&nbsp;in&nbsp;table&nbsp;T1&nbsp;with&nbsp;string&nbsp;containing&nbsp;TEST.&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;2.&nbsp;To&nbsp;search&nbsp;in&nbsp;a&nbsp;multiple&nbsp;table&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXEC&nbsp;SP_SearchTables&nbsp;@Tablenames&nbsp;=&nbsp;'T2'&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,@SearchStr&nbsp;&nbsp;=&nbsp;'%TEST%'&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;above&nbsp;sample&nbsp;searches&nbsp;in&nbsp;tables&nbsp;T1&nbsp;&amp;&nbsp;T2&nbsp;with&nbsp;string&nbsp;containing&nbsp;TEST.&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;3.&nbsp;To&nbsp;search&nbsp;in&nbsp;a&nbsp;all&nbsp;table&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXEC&nbsp;SP_SearchTables&nbsp;@Tablenames&nbsp;=&nbsp;'%'&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,@SearchStr&nbsp;&nbsp;=&nbsp;'%TEST%'&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;above&nbsp;sample&nbsp;searches&nbsp;in&nbsp;all&nbsp;table&nbsp;with&nbsp;string&nbsp;containing&nbsp;TEST.&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;4.&nbsp;Generate&nbsp;the&nbsp;SQL&nbsp;for&nbsp;the&nbsp;Select&nbsp;statements&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXEC&nbsp;SP_SearchTables&nbsp;@Tablenames&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'T1'&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,@SearchStr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'%TEST%'&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,@GenerateSQLOnly&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;5.&nbsp;To&nbsp;Search&nbsp;in&nbsp;tables&nbsp;with&nbsp;specfic&nbsp;name&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXEC&nbsp;SP_SearchTables&nbsp;@Tablenames&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'%T1%'&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,@SearchStr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'%TEST%'&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,@GenerateSQLOnly&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;6.&nbsp;To&nbsp;Search&nbsp;in&nbsp;multiple&nbsp;tables&nbsp;with&nbsp;specfic&nbsp;names&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXEC&nbsp;SP_SearchTables&nbsp;@Tablenames&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'%T1%,Dim%'&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,@SearchStr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'%TEST%'&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,@GenerateSQLOnly&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;7.&nbsp;To&nbsp;specify&nbsp;multiple&nbsp;search&nbsp;strings&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXEC&nbsp;SP_SearchTables&nbsp;@Tablenames&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'%T1%,Dim%'&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,@SearchStr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'%TEST%,TEST1%,%TEST2'&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,@GenerateSQLOnly&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0&nbsp;
&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;8.&nbsp;To&nbsp;search&nbsp;comma&nbsp;itself&nbsp;in&nbsp;the&nbsp;tables&nbsp;use&nbsp;double&nbsp;comma&nbsp;&quot;,,&quot;&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXEC&nbsp;SP_SearchTables&nbsp;@Tablenames&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'%T1%,Dim%'&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,@SearchStr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'%,,%'&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,@GenerateSQLOnly&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXEC&nbsp;SP_SearchTables&nbsp;@Tablenames&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'%T1%,Dim%'&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,@SearchStr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'%with,,comma%'&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,@GenerateSQLOnly&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0&nbsp;
*/</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">SET</span>&nbsp;<span class="sql__id">NOCOUNT</span>&nbsp;<span class="sql__keyword">ON</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">DECLARE</span>&nbsp;<span class="sql__keyword">@</span><span class="sql__variable">MatchFound</span>&nbsp;<span class="sql__keyword">BIT</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">SELECT</span>&nbsp;<span class="sql__keyword">@</span><span class="sql__variable">MatchFound</span>&nbsp;=&nbsp;<span class="sql__number">0</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">DECLARE</span>&nbsp;<span class="sql__keyword">@</span><span class="sql__variable">CheckTableNames</span>&nbsp;<span class="sql__keyword">Table</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__id">Tablename</span>&nbsp;<span class="sql__id">sysname</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;)&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">DECLARE</span>&nbsp;<span class="sql__keyword">@</span><span class="sql__variable">SearchStringTbl</span>&nbsp;<span class="sql__keyword">TABLE</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__id">SearchString</span>&nbsp;<span class="sql__keyword">VARCHAR</span>(<span class="sql__number">500</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;)&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">DECLARE</span>&nbsp;<span class="sql__keyword">@</span><span class="sql__variable">SQLTbl</span>&nbsp;<span class="sql__keyword">TABLE</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__id">Tablename</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__id">SYSNAME</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;,<span class="sql__id">WHEREClause</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">VARCHAR</span>(<span class="sql__id">MAX</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;,<span class="sql__id">SQLStatement</span>&nbsp;&nbsp;&nbsp;<span class="sql__keyword">VARCHAR</span>(<span class="sql__id">MAX</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;,<span class="sql__id">Execstatus</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">BIT</span>&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;)&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">DECLARE</span>&nbsp;<span class="sql__keyword">@</span><span class="sql__variable">SQL</span>&nbsp;<span class="sql__keyword">VARCHAR</span>(<span class="sql__id">MAX</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">DECLARE</span>&nbsp;<span class="sql__keyword">@</span><span class="sql__variable">TblSQL</span>&nbsp;<span class="sql__keyword">VARCHAR</span>(<span class="sql__id">MAX</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">DECLARE</span>&nbsp;<span class="sql__keyword">@</span><span class="sql__variable">tmpTblname</span>&nbsp;<span class="sql__id">sysname</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">DECLARE</span>&nbsp;<span class="sql__keyword">@</span><span class="sql__variable">ErrMsg</span>&nbsp;<span class="sql__keyword">VARCHAR</span>(<span class="sql__number">100</span>)&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">IF</span>&nbsp;<span class="sql__function">LTRIM</span>(<span class="sql__function">RTRIM</span>(<span class="sql__keyword">@</span><span class="sql__variable">Tablenames</span>))&nbsp;<span class="sql__keyword">IN</span>&nbsp;(<span class="sql__string">''</span>&nbsp;,<span class="sql__string">'%'</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">BEGIN</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">INSERT</span>&nbsp;<span class="sql__keyword">INTO</span>&nbsp;<span class="sql__keyword">@</span><span class="sql__variable">CheckTableNames</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">SELECT</span>&nbsp;<span class="sql__keyword">Name</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">FROM</span>&nbsp;<span class="sql__id">sys</span>.<span class="sql__keyword">tables</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">END</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">ELSE</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">BEGIN</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">IF</span>&nbsp;<span class="sql__id">CHARINDEX</span>(<span class="sql__string">','</span>,<span class="sql__keyword">@</span><span class="sql__variable">Tablenames</span>)&nbsp;&gt;&nbsp;<span class="sql__number">0</span>&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">SELECT</span>&nbsp;<span class="sql__keyword">@</span><span class="sql__variable">SQL</span>&nbsp;=&nbsp;<span class="sql__string">'SELECT&nbsp;'''&nbsp;&#43;&nbsp;REPLACE(@Tablenames,',','''as&nbsp;TblName&nbsp;UNION&nbsp;SELECT&nbsp;''')&nbsp;&#43;&nbsp;'''</span>'&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">ELSE</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">SELECT</span>&nbsp;<span class="sql__keyword">@</span><span class="sql__variable">SQL</span>&nbsp;=&nbsp;<span class="sql__string">'SELECT&nbsp;'''&nbsp;&#43;&nbsp;@Tablenames&nbsp;&#43;&nbsp;'''</span>&nbsp;<span class="sql__keyword">as</span>&nbsp;<span class="sql__id">TblName</span>&nbsp;'&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">SELECT</span>&nbsp;<span class="sql__keyword">@</span><span class="sql__variable">TblSQL</span>&nbsp;=&nbsp;'<span class="sql__keyword">SELECT</span>&nbsp;<span class="sql__id">T</span>.<span class="sql__keyword">NAME</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">FROM</span>&nbsp;<span class="sql__id">SYS</span>.<span class="sql__keyword">TABLES</span>&nbsp;<span class="sql__id">T</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">JOIN</span>&nbsp;(<span class="sql__string">'&nbsp;&#43;&nbsp;@SQL&nbsp;&#43;&nbsp;'</span>)&nbsp;<span class="sql__id">tblsrc</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">ON</span>&nbsp;<span class="sql__id">T</span>.<span class="sql__keyword">name</span>&nbsp;<span class="sql__keyword">LIKE</span>&nbsp;<span class="sql__id">tblsrc</span>.<span class="sql__id">tblname</span>&nbsp;'&nbsp;
&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">INSERT</span>&nbsp;<span class="sql__keyword">INTO</span>&nbsp;<span class="sql__keyword">@</span><span class="sql__variable">CheckTableNames</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__id">EXEC</span>(<span class="sql__keyword">@</span><span class="sql__variable">TblSQL</span>)&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">END</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">IF</span>&nbsp;<span class="sql__keyword">NOT</span>&nbsp;<span class="sql__keyword">EXISTS</span>(<span class="sql__keyword">SELECT</span>&nbsp;<span class="sql__number">1</span>&nbsp;<span class="sql__keyword">FROM</span>&nbsp;<span class="sql__keyword">@</span><span class="sql__variable">CheckTableNames</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">BEGIN</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">SELECT</span>&nbsp;<span class="sql__keyword">@</span><span class="sql__variable">ErrMsg</span>&nbsp;=&nbsp;<span class="sql__string">'No&nbsp;tables&nbsp;are&nbsp;found&nbsp;in&nbsp;this&nbsp;database&nbsp;'</span>&nbsp;&#43;&nbsp;<span class="sql__id">DB_NAME</span>()&nbsp;&#43;&nbsp;<span class="sql__string">'&nbsp;for&nbsp;the&nbsp;specified&nbsp;filter'</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__id">PRINT</span>&nbsp;<span class="sql__keyword">@</span><span class="sql__variable">ErrMsg</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">RETURN</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">END</span>&nbsp;
&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">IF</span>&nbsp;<span class="sql__function">LTRIM</span>(<span class="sql__function">RTRIM</span>(<span class="sql__keyword">@</span><span class="sql__variable">SearchStr</span>))&nbsp;=<span class="sql__string">''</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">BEGIN</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">SELECT</span>&nbsp;<span class="sql__keyword">@</span><span class="sql__variable">ErrMsg</span>&nbsp;=&nbsp;<span class="sql__string">'Please&nbsp;specify&nbsp;the&nbsp;search&nbsp;string&nbsp;in&nbsp;@SearchStr&nbsp;Parameter'</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__id">PRINT</span>&nbsp;<span class="sql__keyword">@</span><span class="sql__variable">ErrMsg</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">RETURN</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">END</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">ELSE</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">BEGIN</span>&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">SELECT</span>&nbsp;<span class="sql__keyword">@</span><span class="sql__variable">SearchStr</span>&nbsp;=&nbsp;<span class="sql__keyword">REPLACE</span>(<span class="sql__keyword">@</span><span class="sql__variable">SearchStr</span>,<span class="sql__string">',,,'</span>,<span class="sql__string">',#DOUBLECOMMA#'</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">SELECT</span>&nbsp;<span class="sql__keyword">@</span><span class="sql__variable">SearchStr</span>&nbsp;=&nbsp;<span class="sql__keyword">REPLACE</span>(<span class="sql__keyword">@</span><span class="sql__variable">SearchStr</span>,<span class="sql__string">',,'</span>,<span class="sql__com">'#DOUBLECOMMA#')</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">SELECT</span>&nbsp;<span class="sql__keyword">@</span><span class="sql__variable">SQL</span>&nbsp;=&nbsp;<span class="sql__string">'SELECT&nbsp;'''&nbsp;&#43;&nbsp;REPLACE(@SearchStr,',','''as&nbsp;SearchString&nbsp;UNION&nbsp;SELECT&nbsp;''')&nbsp;&#43;&nbsp;'''</span>'&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">INSERT</span>&nbsp;<span class="sql__keyword">INTO</span>&nbsp;<span class="sql__keyword">@</span><span class="sql__variable">SearchStringTbl</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="sql__id">SearchString</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__id">EXEC</span>(<span class="sql__keyword">@</span><span class="sql__variable">SQL</span>)&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">UPDATE</span>&nbsp;<span class="sql__keyword">@</span><span class="sql__variable">SearchStringTbl</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">SET</span>&nbsp;<span class="sql__id">SearchString</span>&nbsp;=&nbsp;<span class="sql__keyword">REPLACE</span>(<span class="sql__id">SearchString</span>&nbsp;,<span class="sql__com">'#DOUBLECOMMA#',',')</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">END</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">INSERT</span>&nbsp;<span class="sql__keyword">INTO</span>&nbsp;<span class="sql__keyword">@</span><span class="sql__variable">SQLTbl</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;<span class="sql__id">Tablename</span>,<span class="sql__id">WHEREClause</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">SELECT</span>&nbsp;<span class="sql__id">QUOTENAME</span>(<span class="sql__id">SCh</span>.<span class="sql__keyword">name</span>)&nbsp;&#43;&nbsp;<span class="sql__string">'.'</span>&nbsp;&#43;&nbsp;<span class="sql__id">QUOTENAME</span>(<span class="sql__id">ST</span>.<span class="sql__keyword">NAME</span>),&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">SELECT</span>&nbsp;<span class="sql__string">'['&nbsp;&#43;&nbsp;SC.Name&nbsp;&#43;&nbsp;']'&nbsp;&#43;&nbsp;'&nbsp;LIKE&nbsp;'''&nbsp;&#43;&nbsp;SearchSTR.SearchString&nbsp;&#43;&nbsp;'''</span>&nbsp;<span class="sql__keyword">OR</span>&nbsp;'&nbsp;&#43;&nbsp;<span class="sql__keyword">CHAR</span>(<span class="sql__number">10</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">FROM</span>&nbsp;<span class="sql__id">SYS</span>.<span class="sql__keyword">columns</span>&nbsp;<span class="sql__id">SC</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">JOIN</span>&nbsp;<span class="sql__id">SYS</span>.<span class="sql__keyword">types</span>&nbsp;<span class="sql__id">STy</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">ON</span>&nbsp;<span class="sql__id">STy</span>.<span class="sql__id">system_type_id</span>&nbsp;=&nbsp;<span class="sql__id">SC</span>.<span class="sql__id">system_type_id</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">AND</span>&nbsp;<span class="sql__id">STy</span>.<span class="sql__id">user_type_id</span>&nbsp;=<span class="sql__id">SC</span>.<span class="sql__id">user_type_id</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">CROSS</span>&nbsp;<span class="sql__keyword">JOIN</span>&nbsp;<span class="sql__keyword">@</span><span class="sql__variable">SearchStringTbl</span>&nbsp;<span class="sql__id">SearchSTR</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">WHERE</span>&nbsp;<span class="sql__id">STY</span>.<span class="sql__keyword">name</span>&nbsp;<span class="sql__keyword">in</span>&nbsp;(<span class="sql__string">'varchar'</span>,<span class="sql__string">'char'</span>,<span class="sql__string">'nvarchar'</span>,<span class="sql__string">'nchar'</span>,<span class="sql__string">'text'</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">AND</span>&nbsp;<span class="sql__id">SC</span>.<span class="sql__id">object_id</span>&nbsp;=&nbsp;<span class="sql__id">ST</span>.<span class="sql__id">object_id</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">ORDER</span>&nbsp;<span class="sql__keyword">BY</span>&nbsp;<span class="sql__id">SC</span>.<span class="sql__keyword">name</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">FOR</span>&nbsp;<span class="sql__id">XML</span>&nbsp;<span class="sql__id">PATH</span>(<span class="sql__string">''</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">FROM</span>&nbsp;&nbsp;<span class="sql__id">SYS</span>.<span class="sql__keyword">tables</span>&nbsp;<span class="sql__id">ST</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">JOIN</span>&nbsp;<span class="sql__keyword">@</span><span class="sql__variable">CheckTableNames</span>&nbsp;<span class="sql__id">chktbls</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">ON</span>&nbsp;<span class="sql__id">chktbls</span>.<span class="sql__id">Tablename</span>&nbsp;=&nbsp;<span class="sql__id">ST</span>.<span class="sql__keyword">name</span>&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">JOIN</span>&nbsp;<span class="sql__id">SYS</span>.<span class="sql__keyword">schemas</span>&nbsp;<span class="sql__id">SCh</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">ON</span>&nbsp;<span class="sql__id">ST</span>.<span class="sql__id">schema_id</span>&nbsp;=&nbsp;<span class="sql__id">SCh</span>.<span class="sql__id">schema_id</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">WHERE</span>&nbsp;<span class="sql__id">ST</span>.<span class="sql__keyword">name</span>&nbsp;&lt;&gt;&nbsp;<span class="sql__string">'SearchTMP'</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">GROUP</span>&nbsp;<span class="sql__keyword">BY</span>&nbsp;<span class="sql__id">ST</span>.<span class="sql__id">object_id</span>,&nbsp;<span class="sql__id">QUOTENAME</span>(<span class="sql__id">SCh</span>.<span class="sql__keyword">name</span>)&nbsp;&#43;&nbsp;<span class="sql__string">'.'</span>&nbsp;&#43;&nbsp;&nbsp;<span class="sql__id">QUOTENAME</span>(<span class="sql__id">ST</span>.<span class="sql__keyword">NAME</span>)&nbsp;;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">UPDATE</span>&nbsp;<span class="sql__keyword">@</span><span class="sql__variable">SQLTbl</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">SET</span>&nbsp;<span class="sql__id">SQLStatement</span>&nbsp;=&nbsp;<span class="sql__string">'SELECT&nbsp;*&nbsp;INTO&nbsp;SearchTMP&nbsp;FROM&nbsp;'</span>&nbsp;&#43;&nbsp;<span class="sql__id">Tablename</span>&nbsp;&#43;&nbsp;<span class="sql__string">'&nbsp;WHERE&nbsp;'</span>&nbsp;&#43;&nbsp;<span class="sql__function">substring</span>(<span class="sql__id">WHEREClause</span>,<span class="sql__number">1</span>,<span class="sql__id">len</span>(<span class="sql__id">WHEREClause</span>)-<span class="sql__number">5</span>)&nbsp;
&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">DELETE</span>&nbsp;<span class="sql__keyword">FROM</span>&nbsp;<span class="sql__keyword">@</span><span class="sql__variable">SQLTbl</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">WHERE</span>&nbsp;<span class="sql__id">WHEREClause</span>&nbsp;<span class="sql__keyword">IS</span>&nbsp;<span class="sql__value">NULL</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">WHILE</span>&nbsp;<span class="sql__keyword">EXISTS</span>&nbsp;(<span class="sql__keyword">SELECT</span>&nbsp;<span class="sql__number">1</span>&nbsp;<span class="sql__keyword">FROM</span>&nbsp;<span class="sql__keyword">@</span><span class="sql__variable">SQLTbl</span>&nbsp;<span class="sql__keyword">WHERE</span>&nbsp;<span class="sql__function">ISNULL</span>(<span class="sql__id">Execstatus</span>&nbsp;,<span class="sql__number">0</span>)&nbsp;=&nbsp;<span class="sql__number">0</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">BEGIN</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">SELECT</span>&nbsp;<span class="sql__id">TOP</span>&nbsp;<span class="sql__number">1</span>&nbsp;<span class="sql__keyword">@</span><span class="sql__variable">tmpTblname</span>&nbsp;=&nbsp;<span class="sql__id">Tablename</span>&nbsp;,&nbsp;<span class="sql__keyword">@</span><span class="sql__variable">SQL</span>&nbsp;=&nbsp;<span class="sql__id">SQLStatement</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">FROM</span>&nbsp;<span class="sql__keyword">@</span><span class="sql__variable">SQLTbl</span>&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">WHERE</span>&nbsp;<span class="sql__function">ISNULL</span>(<span class="sql__id">Execstatus</span>&nbsp;,<span class="sql__number">0</span>)&nbsp;=&nbsp;<span class="sql__number">0</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">IF</span>&nbsp;<span class="sql__keyword">@</span><span class="sql__variable">GenerateSQLOnly</span>&nbsp;=&nbsp;<span class="sql__number">0</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">BEGIN</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">IF</span>&nbsp;<span class="sql__id">OBJECT_ID</span>(<span class="sql__string">'SearchTMP'</span>,<span class="sql__string">'U'</span>)&nbsp;<span class="sql__keyword">IS</span>&nbsp;<span class="sql__keyword">NOT</span>&nbsp;<span class="sql__value">NULL</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">DROP</span>&nbsp;<span class="sql__keyword">TABLE</span>&nbsp;<span class="sql__id">SearchTMP</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__id">EXEC</span>&nbsp;(<span class="sql__keyword">@</span><span class="sql__variable">SQL</span>)&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">IF</span>&nbsp;<span class="sql__keyword">EXISTS</span>(<span class="sql__keyword">SELECT</span>&nbsp;<span class="sql__number">1</span>&nbsp;<span class="sql__keyword">FROM</span>&nbsp;<span class="sql__id">SearchTMP</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">BEGIN</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">SELECT</span>&nbsp;<span class="sql__id">Tablename</span>=<span class="sql__keyword">@</span><span class="sql__variable">tmpTblname</span>,*&nbsp;<span class="sql__keyword">FROM</span>&nbsp;<span class="sql__id">SearchTMP</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">SELECT</span>&nbsp;<span class="sql__keyword">@</span><span class="sql__variable">MatchFound</span>&nbsp;=&nbsp;<span class="sql__number">1</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">END</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">END</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">ELSE</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">BEGIN</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__id">PRINT</span>&nbsp;<span class="sql__id">REPLICATE</span>(<span class="sql__string">'-'</span>,<span class="sql__number">100</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__id">PRINT</span>&nbsp;<span class="sql__keyword">@</span><span class="sql__variable">tmpTblname</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__id">PRINT</span>&nbsp;<span class="sql__id">REPLICATE</span>(<span class="sql__string">'-'</span>,<span class="sql__number">100</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__id">PRINT</span>&nbsp;<span class="sql__keyword">replace</span>(<span class="sql__keyword">@</span><span class="sql__variable">SQL</span>,<span class="sql__string">'INTO&nbsp;SearchTMP'</span>,<span class="sql__string">''</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">END</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">UPDATE</span>&nbsp;<span class="sql__keyword">@</span><span class="sql__variable">SQLTbl</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">SET</span>&nbsp;<span class="sql__id">Execstatus</span>&nbsp;=&nbsp;<span class="sql__number">1</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">WHERE</span>&nbsp;<span class="sql__id">Tablename</span>&nbsp;=&nbsp;<span class="sql__keyword">@</span><span class="sql__variable">tmpTblname</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">END</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">IF</span>&nbsp;<span class="sql__keyword">@</span><span class="sql__variable">MatchFound</span>&nbsp;=&nbsp;<span class="sql__number">0</span>&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">BEGIN</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">SELECT</span>&nbsp;<span class="sql__keyword">@</span><span class="sql__variable">ErrMsg</span>&nbsp;=&nbsp;<span class="sql__string">'No&nbsp;Matches&nbsp;are&nbsp;found&nbsp;in&nbsp;this&nbsp;database&nbsp;'</span>&nbsp;&#43;&nbsp;<span class="sql__id">DB_NAME</span>()&nbsp;&#43;&nbsp;<span class="sql__string">'&nbsp;for&nbsp;the&nbsp;specified&nbsp;filter'</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__id">PRINT</span>&nbsp;<span class="sql__keyword">@</span><span class="sql__variable">ErrMsg</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">RETURN</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">END</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql__keyword">SET</span>&nbsp;<span class="sql__id">NOCOUNT</span>&nbsp;<span class="sql__id">OFF</span>&nbsp;
&nbsp;
<span class="sql__id">go</span>&nbsp;
&nbsp;
&nbsp;
</pre>
</div>
</div>
</div>
<div class="endscriptcode">&nbsp;</div>

        </div>
    </body>
</html>