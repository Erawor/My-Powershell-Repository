<?xml version="1.0" encoding="utf-8"?>
<CodeSnippets>
  <Code Content="# Performs a cleanup of WSUS.&#xD;&#xA;# Outputs the results to a text file.&#xD;&#xA;# Adapted and tested by BigTeddy&#xD;&#xA;# 3 July 2012&#xD;&#xA;&#xD;&#xA;$outFilePath = '.\wsusClean.txt'&#xD;&#xA;[reflection.assembly]::LoadWithPartialName(&quot;Microsoft.UpdateServices.Administration&quot;) | out-null&#xD;&#xA;$wsus = [Microsoft.UpdateServices.Administration.AdminProxy]::GetUpdateServer();&#xD;&#xA;$cleanupScope = new-object Microsoft.UpdateServices.Administration.CleanupScope;&#xD;&#xA;$cleanupScope.DeclineSupersededUpdates = $true       &#xD;&#xA;$cleanupScope.DeclineExpiredUpdates         = $true&#xD;&#xA;$cleanupScope.CleanupObsoleteUpdates     = $true&#xD;&#xA;$cleanupScope.CompressUpdates                  = $true&#xD;&#xA;#$cleanupScope.CleanupObsoleteComputers = $true&#xD;&#xA;$cleanupScope.CleanupUnneededContentFiles = $true&#xD;&#xA;$cleanupManager = $wsus.GetCleanupManager();&#xD;&#xA;$cleanupManager.PerformCleanup($cleanupScope) | Out-File -FilePath $outFilePath&#xD;&#xA;" />
  <Code Content="# Performs a cleanup of WSUS.&#xD;&#xA;# Outputs the results to a text file.&#xD;&#xA;# Adapted and tested by BigTeddy&#xD;&#xA;# 3 July 2012&#xD;&#xA;&#xD;&#xA;$outFilePath = '.\wsusClean.txt'&#xD;&#xA;[reflection.assembly]::LoadWithPartialName(&quot;Microsoft.UpdateServices.Administration&quot;) | out-null&#xD;&#xA;$wsus = [Microsoft.UpdateServices.Administration.AdminProxy]::GetUpdateServer();&#xD;&#xA;$cleanupScope = new-object Microsoft.UpdateServices.Administration.CleanupScope;&#xD;&#xA;$cleanupScope.DeclineSupersededUpdates = $true       &#xD;&#xA;$cleanupScope.DeclineExpiredUpdates         = $true&#xD;&#xA;$cleanupScope.CleanupObsoleteUpdates     = $true&#xD;&#xA;$cleanupScope.CompressUpdates                  = $true&#xD;&#xA;#$cleanupScope.CleanupObsoleteComputers = $true&#xD;&#xA;$cleanupScope.CleanupUnneededContentFiles = $true&#xD;&#xA;$cleanupManager = $wsus.GetCleanupManager();&#xD;&#xA;$cleanupManager.PerformCleanup($cleanupScope) | Out-File -FilePath $outFilePath&#xD;&#xA;" />
</CodeSnippets>