<?xml version="1.0" encoding="utf-8"?>
<CodeSnippets>
  <Code Content="# Gets time stamps for all User in the domain that have NOT logged in since after specified date&#xD;&#xA;# Mod by Tilo 2014-04-01&#xD;&#xA;import-module activedirectory &#xD;&#xA;$domain = &quot;domain.mydom.com&quot; &#xD;&#xA;$DaysInactive = 90 &#xD;&#xA;$time = (Get-Date).Adddays(-($DaysInactive))&#xD;&#xA; &#xD;&#xA;# Get all AD User with lastLogonTimestamp less than our time and set to enable&#xD;&#xA;Get-ADUser -Filter {LastLogonTimeStamp -lt $time -and enabled -eq $true} -Properties LastLogonTimeStamp |&#xD;&#xA; &#xD;&#xA;# Output Name and lastLogonTimestamp into CSV &#xD;&#xA;select-object Name,@{Name=&quot;Stamp&quot;; Expression={[DateTime]::FromFileTime($_.lastLogonTimestamp).ToString('yyyy-MM-dd_hh:mm:ss')}} | export-csv OLD_User.csv -notypeinformation" />
  <Code Content="# Gets time stamps for all User in the domain that have NOT logged in since after specified date&#xD;&#xA;# Mod by Tilo 2014-04-01&#xD;&#xA;import-module activedirectory &#xD;&#xA;$domain = &quot;domain.mydom.com&quot; &#xD;&#xA;$DaysInactive = 90 &#xD;&#xA;$time = (Get-Date).Adddays(-($DaysInactive))&#xD;&#xA; &#xD;&#xA;# Get all AD User with lastLogonTimestamp less than our time and set to enable&#xD;&#xA;Get-ADUser -Filter {LastLogonTimeStamp -lt $time -and enabled -eq $true} -Properties LastLogonTimeStamp |&#xD;&#xA; &#xD;&#xA;# Output Name and lastLogonTimestamp into CSV &#xD;&#xA;select-object Name,@{Name=&quot;Stamp&quot;; Expression={[DateTime]::FromFileTime($_.lastLogonTimestamp).ToString('yyyy-MM-dd_hh:mm:ss')}} | export-csv OLD_User.csv -notypeinformation" />
</CodeSnippets>