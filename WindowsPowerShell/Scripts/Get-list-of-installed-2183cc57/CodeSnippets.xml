<?xml version="1.0" encoding="utf-8"?>
<CodeSnippets>
  <Code Content="##############################################################################################&#xD;&#xA;# - GetRemoteInstalledHotfixMailReport.ps1&#xD;&#xA;# - Script by Tim Buntrock&#xD;&#xA;# - Run this script on a server that can access the specified servers.&#xD;&#xA;# - Create the folder strcuture &quot;C:\admin\Scripts\ServerUpdates\updatefiles&quot;&#xD;&#xA;# - Add your servers to the servers textfile &quot;C:\admin\Scripts\ServerUpdates\Servers.txt&quot;&#xD;&#xA;# - Change the &quot;#Set E-mail variables&quot; section -&gt; line 23-27&#xD;&#xA;##############################################################################################&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;#Set date variable&#xD;&#xA;$date = get-date -UFormat &quot;%d%m%Y&quot;&#xD;&#xA;&#xD;&#xA;#Create folder structure&#xD;&#xA;#New-Item -ItemType directory -Path C:\admin\Scripts\ServerUpdates\updatefiles&#xD;&#xA;&#xD;&#xA;#Query server and save it to a csv file&#xD;&#xA;get-content &quot;C:\admin\Scripts\ServerUpdates\Servers.txt&quot; | Where {$_ -AND (Test-Connection $_ -Quiet)} | foreach { Get-Hotfix -computername $_ | Select CSName,Description,HotFixID,InstalledBy,InstalledOn | convertto-csv | out-file &quot;C:\admin\Scripts\ServerUpdates\updatefiles\$_-$date.csv&quot; } &#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;#Set E-mail variables !!! Enter your settings!!!&#xD;&#xA;$EmailFrom = &quot;server@my.domain.com&quot;&#xD;&#xA;$EmailTo = &quot;Admins@my.domain.com&quot;&#xD;&#xA;$Subject = &quot;Server Update Report $date&quot;&#xD;&#xA;$Body = &quot;Find attached the Update reports.&quot;&#xD;&#xA;$SMTPServer = &quot;smtpserver1.my.domain.com&quot;&#xD;&#xA; &#xD;&#xA;&#xD;&#xA;#Files location&#xD;&#xA;$UpdateDir = “C:\admin\Scripts\ServerUpdates\updatefiles”&#xD;&#xA;&#xD;&#xA; &#xD;&#xA;#Send Email with reports&#xD;&#xA;Get-ChildItem $UpdateDir | Where {-NOT $_.PSIsContainer} | foreach {$_.fullname} | Send-MailMessage -Subject $Subject -Body $Body -SmtpServer $SMTPServer -Priority High -To $EmailTo -From $EmailFrom&#xD;&#xA;&#xD;&#xA;#Remove csv files located in updatefiles&#xD;&#xA;remove-item -path C:\admin\Scripts\ServerUpdates\updatefiles\*.*" />
  <Code Content="##############################################################################################&#xD;&#xA;# - GetRemoteInstalledHotfixMailReport.ps1&#xD;&#xA;# - Script by Tim Buntrock&#xD;&#xA;# - Run this script on a server that can access the specified servers.&#xD;&#xA;# - Create the folder strcuture &quot;C:\admin\Scripts\ServerUpdates\updatefiles&quot;&#xD;&#xA;# - Add your servers to the servers textfile &quot;C:\admin\Scripts\ServerUpdates\Servers.txt&quot;&#xD;&#xA;# - Change the &quot;#Set E-mail variables&quot; section -&gt; line 23-27&#xD;&#xA;##############################################################################################&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;#Set date variable&#xD;&#xA;$date = get-date -UFormat &quot;%d%m%Y&quot;&#xD;&#xA;&#xD;&#xA;#Create folder structure&#xD;&#xA;#New-Item -ItemType directory -Path C:\admin\Scripts\ServerUpdates\updatefiles&#xD;&#xA;&#xD;&#xA;#Query server and save it to a csv file&#xD;&#xA;get-content &quot;C:\admin\Scripts\ServerUpdates\Servers.txt&quot; | Where {$_ -AND (Test-Connection $_ -Quiet)} | foreach { Get-Hotfix -computername $_ | Select CSName,Description,HotFixID,InstalledBy,InstalledOn | convertto-csv | out-file &quot;C:\admin\Scripts\ServerUpdates\updatefiles\$_-$date.csv&quot; } &#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;#Set E-mail variables !!! Enter your settings!!!&#xD;&#xA;$EmailFrom = &quot;server@my.domain.com&quot;&#xD;&#xA;$EmailTo = &quot;Admins@my.domain.com&quot;&#xD;&#xA;$Subject = &quot;Server Update Report $date&quot;&#xD;&#xA;$Body = &quot;Find attached the Update reports.&quot;&#xD;&#xA;$SMTPServer = &quot;smtpserver1.my.domain.com&quot;&#xD;&#xA; &#xD;&#xA;&#xD;&#xA;#Files location&#xD;&#xA;$UpdateDir = “C:\admin\Scripts\ServerUpdates\updatefiles”&#xD;&#xA;&#xD;&#xA; &#xD;&#xA;#Send Email with reports&#xD;&#xA;Get-ChildItem $UpdateDir | Where {-NOT $_.PSIsContainer} | foreach {$_.fullname} | Send-MailMessage -Subject $Subject -Body $Body -SmtpServer $SMTPServer -Priority High -To $EmailTo -From $EmailFrom&#xD;&#xA;&#xD;&#xA;#Remove csv files located in updatefiles&#xD;&#xA;remove-item -path C:\admin\Scripts\ServerUpdates\updatefiles\*.*" />
</CodeSnippets>