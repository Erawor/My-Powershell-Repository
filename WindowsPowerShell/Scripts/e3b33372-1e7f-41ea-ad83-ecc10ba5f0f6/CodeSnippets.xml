<?xml version="1.0" encoding="utf-8"?>
<CodeSnippets>
  <Code Content="&#xD;&#xA;[reflection.assembly]::LoadWithPartialName(&quot;Microsoft.UpdateServices.Administration&quot;) | out-null&#xD;&#xA;$wsus = [Microsoft.UpdateServices.Administration.AdminProxy]::GetUpdateServer();&#xD;&#xA;$groupName = “All Computers”&#xD;&#xA;$computerName = “my computer”&#xD;&#xA;$approveUpdates = $true&#xD;&#xA;&#xD;&#xA;$group = $null&#xD;&#xA;$computer = $wsus.GetComputerTargetByName($computerName)&#xD;&#xA;$groups = $computer.GetComputerTargetGroups() | foreach-object {&#xD;&#xA;                If ($_.Name  -eq  $groupName) {&#xD;&#xA;                                $group = $_;&#xD;&#xA;}&#xD;&#xA;}&#xD;&#xA;Function GetComputerGroupByName ($group) {&#xD;&#xA;$wsus.GetComputerTargetGroups() | foreach-object { &#xD;&#xA;                if ($_.Name  -eq  $group) {$_;}&#xD;&#xA;                }&#xD;&#xA;}&#xD;&#xA;if ($group -eq $null) {throw new-object System.Exception($computerName + &quot; doesn't below to group &quot; + $groupName)}&#xD;&#xA;&#xD;&#xA;$updateScope = new-object Microsoft.UpdateServices.Administration.UpdateScope;&#xD;&#xA;$updateScope.IncludedInstallationStates = &quot;NotInstalled&quot;&#xD;&#xA;$updateScope.ApprovedStates = &quot;NotApproved&quot;&#xD;&#xA;&#xD;&#xA;$action = [Microsoft.UpdateServices.Administration.UpdateApprovalAction]::Install;&#xD;&#xA;$updates = $computer.GetUpdateInstallationInfoPerUpdate($updateScope);&#xD;&#xA;$updates | foreach-object {&#xD;&#xA;$u = $wsus.GetUpdate($_.UpdateId);&#xD;&#xA;If ($approveUpdates) {&#xD;&#xA;$u.Approve($action,$group);&#xD;&#xA;} else {“Need to approve “ + $u.Title}&#xD;&#xA;};&#xD;&#xA;" />
</CodeSnippets>