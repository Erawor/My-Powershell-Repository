<?xml version="1.0" encoding="utf-8"?>
<CodeSnippets>
  <Code Content="'==========================================================================&#xD;&#xA;'&#xD;&#xA;' VBScript Source File -- Created with SAPIEN Technologies PrimalScript 2009&#xD;&#xA;'&#xD;&#xA;' NAME:  Delete Temp Files&#xD;&#xA;'&#xD;&#xA;' AUTHOR: Mohammed Alyafae , &#xD;&#xA;' DATE  : 9/21/2011&#xD;&#xA;'&#xD;&#xA;' COMMENT: this script delete all user and system temporary files and folder &#xD;&#xA;' also delete Internet Temporary files &#xD;&#xA;'==========================================================================&#xD;&#xA;&#xD;&#xA;Option Explicit&#xD;&#xA;Dim objShell&#xD;&#xA;Dim objSysEnv,objUserEnv&#xD;&#xA;Dim strUserTemp&#xD;&#xA;Dim strSysTemp&#xD;&#xA;Dim userProfile,TempInternetFiles&#xD;&#xA;Dim OSType&#xD;&#xA;&#xD;&#xA;Set objShell=CreateObject(&quot;WScript.Shell&quot;)&#xD;&#xA;&#xD;&#xA;Set objSysEnv=objShell.Environment(&quot;System&quot;)&#xD;&#xA;Set objUserEnv=objShell.Environment(&quot;User&quot;)&#xD;&#xA;&#xD;&#xA;strUserTemp= objShell.ExpandEnvironmentStrings(objUserEnv(&quot;TEMP&quot;))&#xD;&#xA;strSysTemp= objShell.ExpandEnvironmentStrings(objSysEnv(&quot;TEMP&quot;))&#xD;&#xA;userProfile = objShell.ExpandEnvironmentStrings(&quot;%userprofile%&quot;)&#xD;&#xA;&#xD;&#xA;DeleteTemp strUserTemp 'delete user temp files&#xD;&#xA;&#xD;&#xA;DeleteTemp strSysTemp  'delete system temp files&#xD;&#xA;&#xD;&#xA; 'delete Internet Temp files&#xD;&#xA; 'the Internet Temp files path is diffrent according to OS Type&#xD;&#xA;OSType=FindOSType&#xD;&#xA;&#xD;&#xA;If OSType=&quot;Windows 7&quot; Or OSType=&quot;Windows Vista&quot; Then&#xD;&#xA;TempInternetFiles=userProfile &amp; &quot;\AppData\Local\Microsoft\Windows\Temporary Internet Files&quot;&#xD;&#xA;ElseIf  OSType=&quot;Windows 2003&quot; Or OSType=&quot;Windows XP&quot; Then&#xD;&#xA;TempInternetFiles=userProfile &amp; &quot;\Local Settings\Temporary Internet Files&quot;&#xD;&#xA;End If&#xD;&#xA;&#xD;&#xA;DeleteTemp TempInternetFiles&#xD;&#xA;'this is also to delete Content.IE5 in Internet Temp files&#xD;&#xA;TempInternetFiles=TempInternetFiles &amp; &quot;\Content.IE5&quot;&#xD;&#xA;DeleteTemp TempInternetFiles&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;WScript.Quit&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;Sub DeleteTemp (strTempPath)&#xD;&#xA;On Error Resume Next&#xD;&#xA;&#xD;&#xA;Dim objFSO&#xD;&#xA;Dim objFolder,objDir&#xD;&#xA;Dim objFile&#xD;&#xA;Dim i&#xD;&#xA;&#xD;&#xA;Set objFSO=CreateObject(&quot;Scripting.FileSystemObject&quot;)&#xD;&#xA;Set objFolder=objFSO.GetFolder(strTempPath)&#xD;&#xA;&#xD;&#xA;'delete all files&#xD;&#xA;For Each objFile In objFolder.Files&#xD;&#xA;objFile.delete True&#xD;&#xA;Next&#xD;&#xA;&#xD;&#xA;'delete all subfolders&#xD;&#xA;For i=0 To 10&#xD;&#xA;&#x9;For Each objDir In objFolder.SubFolders&#xD;&#xA;&#x9;objDir.Delete True&#xD;&#xA;&#x9;Next&#xD;&#xA;Next&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;'clear all objects&#xD;&#xA;&#xD;&#xA;Set objFSO=Nothing&#xD;&#xA;Set objFolder=Nothing&#xD;&#xA;Set objDir=Nothing&#xD;&#xA;Set objFile=Nothing&#xD;&#xA;End Sub&#xD;&#xA;&#xD;&#xA;Function FindOSType&#xD;&#xA;    'Defining Variables&#xD;&#xA;    Dim objWMI, objItem, colItems&#xD;&#xA;    Dim OSVersion, OSName&#xD;&#xA; &#x9;Dim ComputerName&#xD;&#xA; &#x9;&#xD;&#xA; &#x9;ComputerName=&quot;.&quot;&#xD;&#xA; &#x9;&#xD;&#xA;    'Get the WMI object and query results&#xD;&#xA;    Set objWMI = GetObject(&quot;winmgmts:\\&quot; &amp; ComputerName &amp; &quot;\root\cimv2&quot;)&#xD;&#xA;    Set colItems = objWMI.ExecQuery(&quot;Select * from Win32_OperatingSystem&quot;,,48)&#xD;&#xA; &#xD;&#xA;    'Get the OS version number (first two) and OS product type (server or desktop) &#xD;&#xA;    For Each objItem in colItems&#xD;&#xA;        OSVersion = Left(objItem.Version,3)&#xD;&#xA;                &#xD;&#xA;    Next&#xD;&#xA; &#xD;&#xA;    &#xD;&#xA;    Select Case OSVersion&#xD;&#xA;        Case &quot;6.1&quot;&#xD;&#xA;        &#x9;OSName = &quot;Windows 7&quot;&#xD;&#xA;        Case &quot;6.0&quot; &#xD;&#xA;            OSName = &quot;Windows Vista&quot;&#xD;&#xA;        Case &quot;5.2&quot; &#xD;&#xA;            OSName = &quot;Windows 2003&quot;&#xD;&#xA;        Case &quot;5.1&quot; &#xD;&#xA;            OSName = &quot;Windows XP&quot;&#xD;&#xA;        Case &quot;5.0&quot; &#xD;&#xA;            OSName = &quot;Windows 2000&quot;&#xD;&#xA;   End Select&#xD;&#xA; &#xD;&#xA;    'Return the OS name&#xD;&#xA;    FindOSType = OSName&#xD;&#xA;    &#xD;&#xA;    'Clear the memory&#xD;&#xA;    Set colItems = Nothing&#xD;&#xA;    Set objWMI = Nothing&#xD;&#xA;End Function&#xD;&#xA;" />
  <Code Content="'==========================================================================&#xD;&#xA;'&#xD;&#xA;' VBScript Source File -- Created with SAPIEN Technologies PrimalScript 2009&#xD;&#xA;'&#xD;&#xA;' NAME:  Delete Temp Files&#xD;&#xA;'&#xD;&#xA;' AUTHOR: Mohammed Alyafae , &#xD;&#xA;' DATE  : 9/21/2011&#xD;&#xA;'&#xD;&#xA;' COMMENT: this script delete all user and system temporary files and folder &#xD;&#xA;' also delete Internet Temporary files &#xD;&#xA;'==========================================================================&#xD;&#xA;&#xD;&#xA;Option Explicit&#xD;&#xA;Dim objShell&#xD;&#xA;Dim objSysEnv,objUserEnv&#xD;&#xA;Dim strUserTemp&#xD;&#xA;Dim strSysTemp&#xD;&#xA;Dim userProfile,TempInternetFiles&#xD;&#xA;Dim OSType&#xD;&#xA;&#xD;&#xA;Set objShell=CreateObject(&quot;WScript.Shell&quot;)&#xD;&#xA;&#xD;&#xA;Set objSysEnv=objShell.Environment(&quot;System&quot;)&#xD;&#xA;Set objUserEnv=objShell.Environment(&quot;User&quot;)&#xD;&#xA;&#xD;&#xA;strUserTemp= objShell.ExpandEnvironmentStrings(objUserEnv(&quot;TEMP&quot;))&#xD;&#xA;strSysTemp= objShell.ExpandEnvironmentStrings(objSysEnv(&quot;TEMP&quot;))&#xD;&#xA;userProfile = objShell.ExpandEnvironmentStrings(&quot;%userprofile%&quot;)&#xD;&#xA;&#xD;&#xA;DeleteTemp strUserTemp 'delete user temp files&#xD;&#xA;&#xD;&#xA;DeleteTemp strSysTemp  'delete system temp files&#xD;&#xA;&#xD;&#xA; 'delete Internet Temp files&#xD;&#xA; 'the Internet Temp files path is diffrent according to OS Type&#xD;&#xA;OSType=FindOSType&#xD;&#xA;&#xD;&#xA;If OSType=&quot;Windows 7&quot; Or OSType=&quot;Windows Vista&quot; Then&#xD;&#xA;TempInternetFiles=userProfile &amp; &quot;\AppData\Local\Microsoft\Windows\Temporary Internet Files&quot;&#xD;&#xA;ElseIf  OSType=&quot;Windows 2003&quot; Or OSType=&quot;Windows XP&quot; Then&#xD;&#xA;TempInternetFiles=userProfile &amp; &quot;\Local Settings\Temporary Internet Files&quot;&#xD;&#xA;End If&#xD;&#xA;&#xD;&#xA;DeleteTemp TempInternetFiles&#xD;&#xA;'this is also to delete Content.IE5 in Internet Temp files&#xD;&#xA;TempInternetFiles=TempInternetFiles &amp; &quot;\Content.IE5&quot;&#xD;&#xA;DeleteTemp TempInternetFiles&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;WScript.Quit&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;Sub DeleteTemp (strTempPath)&#xD;&#xA;On Error Resume Next&#xD;&#xA;&#xD;&#xA;Dim objFSO&#xD;&#xA;Dim objFolder,objDir&#xD;&#xA;Dim objFile&#xD;&#xA;Dim i&#xD;&#xA;&#xD;&#xA;Set objFSO=CreateObject(&quot;Scripting.FileSystemObject&quot;)&#xD;&#xA;Set objFolder=objFSO.GetFolder(strTempPath)&#xD;&#xA;&#xD;&#xA;'delete all files&#xD;&#xA;For Each objFile In objFolder.Files&#xD;&#xA;objFile.delete True&#xD;&#xA;Next&#xD;&#xA;&#xD;&#xA;'delete all subfolders&#xD;&#xA;For i=0 To 10&#xD;&#xA;&#x9;For Each objDir In objFolder.SubFolders&#xD;&#xA;&#x9;objDir.Delete True&#xD;&#xA;&#x9;Next&#xD;&#xA;Next&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;'clear all objects&#xD;&#xA;&#xD;&#xA;Set objFSO=Nothing&#xD;&#xA;Set objFolder=Nothing&#xD;&#xA;Set objDir=Nothing&#xD;&#xA;Set objFile=Nothing&#xD;&#xA;End Sub&#xD;&#xA;&#xD;&#xA;Function FindOSType&#xD;&#xA;    'Defining Variables&#xD;&#xA;    Dim objWMI, objItem, colItems&#xD;&#xA;    Dim OSVersion, OSName&#xD;&#xA; &#x9;Dim ComputerName&#xD;&#xA; &#x9;&#xD;&#xA; &#x9;ComputerName=&quot;.&quot;&#xD;&#xA; &#x9;&#xD;&#xA;    'Get the WMI object and query results&#xD;&#xA;    Set objWMI = GetObject(&quot;winmgmts:\\&quot; &amp; ComputerName &amp; &quot;\root\cimv2&quot;)&#xD;&#xA;    Set colItems = objWMI.ExecQuery(&quot;Select * from Win32_OperatingSystem&quot;,,48)&#xD;&#xA; &#xD;&#xA;    'Get the OS version number (first two) and OS product type (server or desktop) &#xD;&#xA;    For Each objItem in colItems&#xD;&#xA;        OSVersion = Left(objItem.Version,3)&#xD;&#xA;                &#xD;&#xA;    Next&#xD;&#xA; &#xD;&#xA;    &#xD;&#xA;    Select Case OSVersion&#xD;&#xA;        Case &quot;6.1&quot;&#xD;&#xA;        &#x9;OSName = &quot;Windows 7&quot;&#xD;&#xA;        Case &quot;6.0&quot; &#xD;&#xA;            OSName = &quot;Windows Vista&quot;&#xD;&#xA;        Case &quot;5.2&quot; &#xD;&#xA;            OSName = &quot;Windows 2003&quot;&#xD;&#xA;        Case &quot;5.1&quot; &#xD;&#xA;            OSName = &quot;Windows XP&quot;&#xD;&#xA;        Case &quot;5.0&quot; &#xD;&#xA;            OSName = &quot;Windows 2000&quot;&#xD;&#xA;   End Select&#xD;&#xA; &#xD;&#xA;    'Return the OS name&#xD;&#xA;    FindOSType = OSName&#xD;&#xA;    &#xD;&#xA;    'Clear the memory&#xD;&#xA;    Set colItems = Nothing&#xD;&#xA;    Set objWMI = Nothing&#xD;&#xA;End Function&#xD;&#xA;" />
</CodeSnippets>