<?xml version="1.0" encoding="utf-8"?>
<CodeSnippets>
  <Code Content="&#xD;&#xA;[reflection.assembly]::LoadWithPartialName(&quot;Microsoft.UpdateServices.Administration&quot;) | out-null&#xD;&#xA;$wsus = [Microsoft.UpdateServices.Administration.AdminProxy]::GetUpdateServer();&#xD;&#xA; &#xD;&#xA;$updateScope = new-object Microsoft.UpdateServices.Administration.UpdateScope;&#xD;&#xA;$updateScope.ApprovedStates = [Microsoft.UpdateServices.Administration.ApprovedStates]::LatestRevisionApproved;&#xD;&#xA;$updateScope.UpdateSources = [Microsoft.UpdateServices.Administration.UpdateSources]::MicrosoftUpdate;&#xD;&#xA; &#xD;&#xA;$computerScope = new-object Microsoft.UpdateServices.Administration.ComputerTargetScope;&#xD;&#xA; &#xD;&#xA; &#xD;&#xA;$updatesFailed = $updatesNeeded = $updatesUpToDate = 0;&#xD;&#xA;$updates = $wsus.GetSummariesPerUpdate($updateScope, $computerScope);&#xD;&#xA;$updates | foreach-object {&#xD;&#xA;     if ($_.FailedCount) {&#xD;&#xA;           $updatesFailed++;&#xD;&#xA;     }&#xD;&#xA;     elseif ($_.DownloadedCount -or $_.InstalledPendingRebootCount -or $_.NotInstalledCount) {&#xD;&#xA;          $updatesNeeded++;&#xD;&#xA;     }&#xD;&#xA;     elseif (!$_.UnknownCount) {&#xD;&#xA;          $updatesUpToDate++;&#xD;&#xA;     }&#xD;&#xA;}&#xD;&#xA; &#xD;&#xA;$computersFailed = $computersNeeded = $computersUpToDate = 0;&#xD;&#xA;$computers = $wsus.GetSummariesPerComputerTarget($updateScope, $computerScope);&#xD;&#xA;$computers | foreach-object {&#xD;&#xA; &#xD;&#xA;     if ($_.FailedCount) {&#xD;&#xA;           $computersFailed++;&#xD;&#xA;     }&#xD;&#xA;     elseif ($_.DownloadedCount -or $_.InstalledPendingRebootCount -or $_.NotInstalledCount) {&#xD;&#xA;           $computersNeeded++;&#xD;&#xA;     }&#xD;&#xA;     elseif (!$_.UnknownCount) {&#xD;&#xA;           $computersUpToDate++;&#xD;&#xA;     }&#xD;&#xA;}&#xD;&#xA; &#xD;&#xA;$wsus.ServerName+&quot;,&quot;+[DateTime]::UtcNow.ToShortDateString()+&quot;,&quot;+&#xD;&#xA;$computers.Count+&quot;,&quot;+$updates.Count+&quot;,&quot;+&#xD;&#xA;$computersUpToDate+&quot;,&quot;+$computersNeeded+&quot;,&quot;+$computersFailed+&quot;,&quot;+&#xD;&#xA;$updatesUpToDate+&quot;,&quot;+$updatesNeeded+&quot;,&quot;+$updatesFailed;&#xD;&#xA;" />
</CodeSnippets>