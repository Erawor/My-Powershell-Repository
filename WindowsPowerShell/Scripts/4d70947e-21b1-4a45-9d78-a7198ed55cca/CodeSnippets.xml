<?xml version="1.0" encoding="utf-8"?>
<CodeSnippets>
  <Code Content="# This script shows the last time that a successfull Windows Update was installed.&#xD;&#xA;&#xD;&#xA;cls&#xD;&#xA;add-PSSnapin quest.activeroles.admanagement&#xD;&#xA;$OnlineServers = @()&#xD;&#xA;&#xD;&#xA;Get-QADComputer -SearchRoot 'domain.com/ServerOU'  -OSName &quot;Windows*Server*&quot; | %{&#xD;&#xA;  &#xD;&#xA;  $PingResult = Get-WmiObject -Query &quot;SELECT * FROM win32_PingStatus WHERE address='$($_.Name)'&quot;&#xD;&#xA;  &#xD;&#xA;  If ($PingResult.StatusCode -eq 0) &#xD;&#xA;  {&#xD;&#xA;     # Add the current name to the array&#xD;&#xA;    $OnlineServers += &quot;$($_.Name)&quot;&#xD;&#xA;  }&#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;foreach ($Server in $OnlineServers )&#xD;&#xA;{&#xD;&#xA;&#x9;&#xD;&#xA;&#x9;&#x9;$key = “SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Auto Update\Results\Install”&#xD;&#xA;&#x9;&#x9;$keytype = [Microsoft.Win32.RegistryHive]::LocalMachine&#xD;&#xA;&#x9;&#x9;$RemoteBase = [Microsoft.Win32.RegistryKey]::OpenRemoteBaseKey($keytype,$Server)&#xD;&#xA;&#x9;&#x9;$regKey = $RemoteBase.OpenSubKey($key)&#xD;&#xA;&#x9;&#x9;$KeyValue = $regkey.GetValue(”LastSuccessTime”)&#xD;&#xA;&#x9;&#xD;&#xA;&#x9;&#x9;$System = (Get-Date -Format &quot;yyyy-MM-dd hh:mm:ss&quot;) &#xD;&#xA;&#x9;&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;if&#x9;($KeyValue -lt $System)&#xD;&#xA;&#x9;&#x9;{&#xD;&#xA;&#x9;&#x9;&#x9;Write-Host &quot; &quot;&#xD;&#xA;&#x9;&#x9;&#x9;Write-Host $Server &quot;Last time updates were installed was: &quot; $KeyValue&#xD;&#xA;&#x9;&#x9;}&#xD;&#xA;&#x9;}" />
</CodeSnippets>