<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head>
        <title>Get-ClientWSUSSetting</title>        
        <meta name="description" content="&#160;This script allows you to query a system or systems to find the wsus client settings. This performs a registry lookup for both the Environment and Configuration keys and allows you to specify if you prefer to view one of the
 other. By not specifying Environment or Configuratio" />
        <link href="https://i1.code.msdn.s-msft.com/RequestReduceContent/c82dc8ab865be0fb7316b2e09ac97654-bafb67d64bd55a2b1fd123070a82b424-RequestReducedStyle.css" rel="Stylesheet" type="text/css" />        
        <script src="https://ajax.aspnetcdn.com/ajax/jquery/jquery-1.6.1.min.js" type="text/javascript" ></script>
        <script src="https://i1.code.msdn.s-msft.com/RequestReduceContent/a12c72272a8fe142a00d8aae0ff5525e-cf9957f54e208c66abb738158989dd84-RequestReducedScript.js" type="text/javascript" ></script>                        <script type="text/javascript">
            function initializePage() {
                var activeTabData = 'activeTab';
                var otherTabClass = 'otherTab';
                var hiddenPreClass = 'hidden';
                $("a[href^=#]").attr("target","_self");
                $("div.scriptcode").each(function (i) {
                    var scriptBlock = $(this);
                    scriptBlock.trackCopy(trackCodeSnippetCodeDownload);
                    var labelElems = scriptBlock.find("div.title > span");
                    if (labelElems.length == 0) {
                        labelElems = scriptBlock.find("div.title");
                    }
                    var languageSpans = scriptBlock.find("span.hidden");
                    var pres = scriptBlock.find("pre");
                    if (languageSpans.length > 0 && pres.length > 1) {
                        labelElems.each(function(index, elem) {
                            var codePre = $(pres[index]);
                            var labelSpan = $(elem);
                            var languageSpan = $(languageSpans[index]);
                            labelSpan.data('code', codePre.text().replace(/(\r(\n)?)|((\r)?\n)/ig, '\r\n'));
                            codePre.removeClass(hiddenPreClass);  
                            codePre.addClass(languageSpan.text().replace(/^\s+|\s+$/g,""));
                            codePre.chili();
                            languageSpan.remove();
                        });

                        pres = scriptBlock.find("pre");
                        labelElems.each(function(index, elem) {
                            var codePre = $(pres[index]);
                            var labelSpan = $(elem);
                            if (index == 0) {
                                scriptBlock.data(activeTabData, 0);
                            }
                            else {
                                labelSpan.addClass(otherTabClass);
                                codePre.addClass(hiddenPreClass);  
                            }
                            labelSpan.click(function (e) {
                                var activeTab = scriptBlock.data(activeTabData);
                                $(labelElems[activeTab]).addClass(otherTabClass);   
                                $(pres[activeTab]).addClass(hiddenPreClass);   
                                        
                                codePre.removeClass(hiddenPreClass);    
                                labelSpan.removeClass(otherTabClass);
                                scriptBlock.data(activeTabData, index);

                                if( window.parent.Galleries ) {
                                    window.parent.Galleries.project.resizeDesc();
                                }
                            });
                        });

                        var preview = scriptBlock.find('div.preview');
                        if (preview.length == 0) {
                            preview = $(pres[pres.length - 1]);
                        }
                        preview.remove();

                        if (window.clipboardData && clipboardData.setData) {
                            var copyLink = $("<a href='#' class='copyCode'>Copy code</a>");
                            copyLink.click(function (e) {
                                trackCodeSnippetCodeDownload();
                                clipboardData.setData("Text", $(labelElems[scriptBlock.data(activeTabData)]).data('code'));
                                return false;
                            });
                            $(this).prepend(copyLink);
                        }
                    }
                });

                if ((window.parent) && (window.parent.Galleries)) {
                    window.parent.Galleries.project.resizeDesc();
                }

                    if (top.location == self.location) {
                         window.location.replace(window.location.href.replace('/description', ''));
                    }
            }

            function trackCodeSnippetCodeDownload() {
                if ((window.parent) && (window.parent.gTracker)) {
                    window.parent.gTracker.createActionEvent('Description', 'Download', 'Copy', 'CodeSnippet', null);
                }
            }
            
            function overrideAnchorLinksForFirefoxAndChrome(iframeId) {
                if(($.browser.mozilla && parseInt($.browser.version, 10) >= 2) || $.browser.webkit) {
                    var iframeOffset = $("#" + iframeId, window.parent.document).offset();
                    $("a").each(function () {
                        var link = $(this);
                        var href = link.attr("href");
                        if (href && href[0] == "#") {
                            var name = href.substring(1);
                            $(this).click(function () {
                                var nameElement = $("[name='" + name + "']");
                                var idElement = $("#" + name);
                                var element = null;
                                if (nameElement.length > 0) {
                                    element = nameElement;
                                } else if (idElement.length > 0) {
                                    element = idElement;
                                }

                                if (element) {
                                    var offset = element.offset();
                                    window.parent.scrollTo(offset.left, offset.top + iframeOffset.top);
                                }

                                return false;
                            });
                        }
                    });
                }
            }

            $(window).load(function(){
                initializePage();
                overrideAnchorLinksForFirefoxAndChrome("longdescIframe");

            });

        </script>
        <base target="_parent" />
    </head>
    <body>
        <div id="longDesc">
            
<p><span style="font-size:small">&nbsp;</span></p>
<p><span style="font-size:small">This script allows you to query a system or systems to find the wsus client settings. This performs a registry lookup for both the Environment and Configuration keys and allows you to specify if you prefer to view one of the
 other. By not specifying Environment or Configuration, both of the results will be displayed for you to view.</span></p>
<p>&nbsp;</p>
<p><span style="font-size:small">This script will be used in the <a href="http://blogs.technet.com/b/heyscriptingguy/archive/2012/01/16/introduction-to-wsus-and-powershell.aspx" target="_blank">
January 16th Hey, Scripting Guy blog</a>.</span></p>
<p><span style="font-size:small">Reference:</span></p>
<p><span style="font-size:small"><a href="http://technet.microsoft.com/en-us/library/cc708449(WS.10).aspx">http://technet.microsoft.com/en-us/library/cc708449(WS.10).aspx</a></span></p>
<p>&nbsp;</p>
<h1>Examples:</h1>
<p><span style="font-size:small"><strong>Get-ClientWSUSSetting -Computer TestServer</strong></span></p>
<div class="endscriptcode"><span style="font-size:small"><em>&nbsp;&nbsp;&nbsp; RescheduleWaitTime&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : NA</em></span><br>
<span style="font-size:small"><em>&nbsp;&nbsp;&nbsp; AutoInstallMinorUpdates&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : NA</em></span><br>
<span style="font-size:small"><em>&nbsp;&nbsp;&nbsp; TargetGroupEnabled&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : NA</em></span><br>
<span style="font-size:small"><em>&nbsp;&nbsp;&nbsp; ScheduledInstallDay&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : NA</em></span><br>
<span style="font-size:small"><em>&nbsp;&nbsp;&nbsp; DetectionFrequencyEnabled&nbsp;&nbsp;&nbsp;&nbsp; : 1</em></span><br>
<span style="font-size:small"><em>&nbsp;&nbsp;&nbsp; WUServer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; :
<a href="http://wsus.com">http://wsus.com</a></em></span><br>
<span style="font-size:small"><em>&nbsp;&nbsp;&nbsp; Computername&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : TestServer</em></span><br>
<span style="font-size:small"><em>&nbsp;&nbsp;&nbsp; RebootWarningTimeoutEnabled&nbsp;&nbsp; : NA</em></span><br>
<span style="font-size:small"><em>&nbsp;&nbsp;&nbsp; ElevateNonAdmins&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : NA</em></span><br>
<span style="font-size:small"><em>&nbsp;&nbsp;&nbsp; ScheduledInstallTime&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : NA</em></span><br>
<span style="font-size:small"><em>&nbsp;&nbsp;&nbsp; RebootRelaunchTimeout&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : 10</em></span><br>
<span style="font-size:small"><em>&nbsp;&nbsp;&nbsp; ScheduleInstallDay&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : NA</em></span><br>
<span style="font-size:small"><em>&nbsp;&nbsp;&nbsp; RescheduleWaitTimeEnabled&nbsp;&nbsp;&nbsp;&nbsp; : NA</em></span><br>
<span style="font-size:small"><em>&nbsp;&nbsp;&nbsp; DisableWindowsUpdateAccess&nbsp;&nbsp;&nbsp; : NA</em></span><br>
<span style="font-size:small"><em>&nbsp;&nbsp;&nbsp; AUOptions&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : 3</em></span><br>
<span style="font-size:small"><em>&nbsp;&nbsp;&nbsp; DetectionFrequency&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : 4</em></span><br>
<span style="font-size:small"><em>&nbsp;&nbsp;&nbsp; RebootWarningTimeout&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : NA</em></span><br>
<span style="font-size:small"><em>&nbsp;&nbsp;&nbsp; ScheduleInstallTime&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : NA</em></span><br>
<span style="font-size:small"><em>&nbsp;&nbsp;&nbsp; WUStatusServer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; :
<a href="http://wsus.com">http://wsus.com</a></em></span><br>
<span style="font-size:small"><em>&nbsp;&nbsp;&nbsp; TargetGroup&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : NA</em></span><br>
<span style="font-size:small"><em>&nbsp;&nbsp;&nbsp; RebootRelaunchTimeoutEnabled&nbsp; : 1</em></span><br>
<span style="font-size:small"><em>&nbsp;&nbsp;&nbsp; UseWUServer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : 1</em></span><br>
<span style="font-size:small"><em>&nbsp;&nbsp;&nbsp; NoAutoRebootWithLoggedOnUsers : 1&nbsp;</em></span></div>
<div class="endscriptcode"></div>
<div class="endscriptcode"><span style="font-size:small"><strong>Get-ClientWSUSSetting -Computername Server1 -ShowEnvironment</strong></span></div>
<div class="endscriptcode"><strong>&nbsp;</strong></div>
<div class="endscriptcode"><span style="font-size:small"><em>&nbsp;&nbsp;&nbsp; Computername&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : Server1</em></span><br>
<span style="font-size:small"><em>&nbsp;&nbsp;&nbsp; TargetGroupEnabled&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : NA</em></span><br>
<span style="font-size:small"><em>&nbsp;&nbsp;&nbsp; TargetGroup&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : NA</em></span><br>
<span style="font-size:small"><em>&nbsp;&nbsp;&nbsp; WUStatusServer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; :
<a href="http://wsus.com">http://wsus.com</a></em></span><br>
<span style="font-size:small"><em>&nbsp;&nbsp;&nbsp; WUServer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; :
<a href="http://wsus.com">http://wsus.com</a></em></span><br>
<span style="font-size:small"><em>&nbsp;&nbsp;&nbsp; DisableWindowsUpdateAccess : 1</em></span><br>
<span style="font-size:small"><em>&nbsp;&nbsp;&nbsp; ElevateNonAdmins&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : 0</em></span></div>
<div class="endscriptcode"><em>&nbsp;</em></div>
<div class="endscriptcode"><span style="font-size:small"><strong>Get-ClientWSUSSetting -Computername Server1 -ShowConfiguration</strong></span></div>
<div class="endscriptcode"><strong>&nbsp;</strong></div>
<div class="endscriptcode"><span style="font-size:small"><em>&nbsp;&nbsp;&nbsp; ScheduledInstallTime&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : NA<br>
&nbsp;&nbsp;&nbsp; AutoInstallMinorUpdates&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : 0<br>
&nbsp;&nbsp;&nbsp; ScheduledInstallDay&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : NA<br>
&nbsp;&nbsp;&nbsp; Computername&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : Server1<br>
&nbsp;&nbsp;&nbsp; RebootWarningTimeoutEnabled&nbsp;&nbsp; : NA<br>
&nbsp;&nbsp;&nbsp; RebootWarningTimeout&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : NA<br>
&nbsp;&nbsp;&nbsp; NoAUAsDefaultShutdownOption&nbsp;&nbsp; : NA<br>
&nbsp;&nbsp;&nbsp; RebootRelaunchTimeout&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : NA<br>
&nbsp;&nbsp;&nbsp; DetectionFrequency&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : 4<br>
&nbsp;&nbsp;&nbsp; ScheduleInstallDay&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : NA<br>
&nbsp;&nbsp;&nbsp; RescheduleWaitTime&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : NA<br>
&nbsp;&nbsp;&nbsp; RescheduleWaitTimeEnabled&nbsp;&nbsp;&nbsp;&nbsp; : 0<br>
&nbsp;&nbsp;&nbsp; AUOptions&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : 3<br>
&nbsp;&nbsp;&nbsp; NoAutoRebootWithLoggedOnUsers : 1<br>
&nbsp;&nbsp;&nbsp; DetectionFrequencyEnabled&nbsp;&nbsp;&nbsp;&nbsp; : 1<br>
&nbsp;&nbsp;&nbsp; ScheduleInstallTime&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : NA<br>
&nbsp;&nbsp;&nbsp; NoAUShutdownOption&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : NA<br>
&nbsp;&nbsp;&nbsp; RebootRelaunchTimeoutEnabled&nbsp; : NA<br>
&nbsp;&nbsp;&nbsp; UseWUServer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : 1<br>
&nbsp;&nbsp;&nbsp; IncludeRecommendedUpdates&nbsp;&nbsp;&nbsp;&nbsp; : NA</em></span></div>
<div class="endscriptcode"><span style="font-size:small"><em>&nbsp;</em></span></div>
<div class="endscriptcode"><span style="font-size:small"><em>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>PowerShell</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">powershell</span>
<pre class="hidden">. .\Get-ClientWSUSSetting.ps1</pre>
<div class="preview">
<pre class="powershell">.&nbsp;.\Get<span class="powerShell__operator">-</span>ClientWSUSSetting.ps1</pre>
</div>
</div>
</div>
<div class="endscriptcode">&nbsp;</div>
</em></span></div>
<div class="endscriptcode"><span style="font-size:small"><em>&nbsp;</em></span></div>
<div class="endscriptcode"><span style="font-size:small"><em>&nbsp;</em></span></div>
<div class="endscriptcode"><em>&nbsp;</em></div>
<p>&nbsp;</p>
<div class="endscriptcode">&nbsp;</div>

        </div>
    </body>
</html>