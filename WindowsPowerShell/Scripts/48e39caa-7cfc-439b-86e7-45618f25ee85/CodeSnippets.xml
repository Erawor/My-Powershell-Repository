<?xml version="1.0" encoding="utf-8"?>
<CodeSnippets>
  <Code Content="# Configure WSUS Replica Server&#xD;&#xA;&#xD;&#xA;#------------------------------&#xD;&#xA;# Setup Error Logging&#xD;&#xA;$erroractionpreference=&quot;Continue&quot;&#xD;&#xA;$error.clear()&#xD;&#xA;&#xD;&#xA;#------------------------------&#xD;&#xA;# Load the WSUS assenbly DLL and assign it to the $wsus variable&#xD;&#xA;[reflection.assembly]::LoadWithPartialName(&quot;Microsoft.UpdateServices.Administration&quot;) | out-null&#xD;&#xA;$wsus = [Microsoft.UpdateServices.Administration.AdminProxy]::GetUpdateServer();&#xD;&#xA;&#xD;&#xA;#------------------------------&#xD;&#xA;# Assign the wsus configuration property objects to the $wsusconfig variable&#xD;&#xA;$wsusConfig = $wsus.GetConfiguration()&#xD;&#xA;&#xD;&#xA;#------------------------------&#xD;&#xA;# Set the WSUS Update Source to goto another WSUS server rather than Microsoft&#xD;&#xA;$wsusConfig.SyncFromMicrosoftUpdate=$false&#xD;&#xA;&#xD;&#xA;#------------------------------&#xD;&#xA;# Set the Upstream Server Name - Replace Server1 with your Primary WSUS server name&#xD;&#xA;$wsusConfig.UpstreamWsusServerName=&quot;Server1&quot;&#xD;&#xA;&#xD;&#xA;#------------------------------&#xD;&#xA;# Set the Upstream server Port Number - Replace 8530 with your port number&#xD;&#xA;$wsusConfig.UpstreamWsusServerPortNumber=8530&#xD;&#xA;&#xD;&#xA;#------------------------------&#xD;&#xA;# Set the WSUS Server as a Replica of its Upstream Server&#xD;&#xA;$wsusConfig.IsReplicaServer=$True&#xD;&#xA;&#xD;&#xA;#------------------------------&#xD;&#xA;# Set client side targeting for group membership&#xD;&#xA;$wsusConfig.TargetingMode=&quot;Client&quot;&#xD;&#xA;&#xD;&#xA;#------------------------------&#xD;&#xA;# Save the configuration&#xD;&#xA;$wsusConfig.Save()&#xD;&#xA;&#xD;&#xA;#------------------------------&#xD;&#xA;# Assign the wsus Subscription Property objects to the $wsussub variable&#xD;&#xA;$wsusSub = $wsus.GetSubscription()&#xD;&#xA;&#xD;&#xA;#------------------------------&#xD;&#xA;# Set the WSUS Server Syncronisation to Automatic&#xD;&#xA;$wsusSub.SynchronizeAutomatically=$True&#xD;&#xA;&#xD;&#xA;#------------------------------&#xD;&#xA;# Set the WSUS Server Syncronisation Time&#xD;&#xA;$wsusSub.SynchronizeAutomaticallyTimeOfDay=&quot;20:00:00&quot;&#xD;&#xA;&#xD;&#xA;#------------------------------&#xD;&#xA;# Set the WSUS Server Syncronisation Number of Syncs per day&#xD;&#xA;$wsusSub.NumberOfSynchronizationsPerDay=&quot;1&quot;&#xD;&#xA;&#xD;&#xA;#------------------------------&#xD;&#xA;# Save the Syncoronisation Configuration&#xD;&#xA;$wsusSub.Save()&#xD;&#xA;&#xD;&#xA;#------------------------------&#xD;&#xA;# Start a Sync&#xD;&#xA;$wsusSub.StartSynchronization()&#xD;&#xA;&#xD;&#xA;if ($error.count -ne 0)&#xD;&#xA; {&#xD;&#xA; Exit 10&#xD;&#xA; }&#xD;&#xA;" />
</CodeSnippets>