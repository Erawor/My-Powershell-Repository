<?xml version="1.0" encoding="utf-8"?>
<CodeSnippets>
  <Code Content="&#xD;&#xA;[reflection.assembly]::LoadWithPartialName(&quot;Microsoft.UpdateServices.Administration&quot;) | out-null&#xD;&#xA;$wsus = [Microsoft.UpdateServices.Administration.AdminProxy]::GetUpdateServer();&#xD;&#xA;$updateScope = new-object Microsoft.UpdateServices.Administration.UpdateScope;&#xD;&#xA;$updateScope.updateApprovalActions = [Microsoft.UpdateServices.Administration.UpdateApprovalActions]::Install&#xD;&#xA;$wsus.GetUpdates($updateScope) | foreach-object { &#xD;&#xA;if (($_.State -eq [Microsoft.UpdateServices.Administration.UpdateState]::Cancelled) -or&#xD;&#xA;($_.State -eq [Microsoft.UpdateServices.Administration.UpdateState]::Failed) -or&#xD;&#xA;($_.State -eq [Microsoft.UpdateServices.Administration.UpdateState]::LicenseAgreementFailed)) { &#xD;&#xA;$_.ResumeDownload(); &quot;Resuming &quot; + $_.Title;&#xD;&#xA;}&#xD;&#xA;elseif (($_.State -eq [Microsoft.UpdateServices.Administration.UpdateState]::NotReady) -or&#xD;&#xA;($_.State -eq [Microsoft.UpdateServices.Administration.UpdateState]::LicenseAgreementNotReady)) {&#xD;&#xA;&quot;Already downloading &quot; + $_.Title;&#xD;&#xA;}&#xD;&#xA;}&#xD;&#xA;" />
</CodeSnippets>