<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head>
        <title>PowerShell script to list all installed Microsoft Windows Updates</title>        
        <meta name="description" content="A PowerShell script to list all installed Microsoft Windows Updates.Script Updated:17/12/2014: If command &#39;wmic qfe list&#39; returns $null or &#39;&#39; then use &#39;Monday 1 January 0001&#39; as date.Find me on LinkedIN:&#160;nz.linkedin.com/pub/topaz-paul/19/275/328/PowerShell Version 2 or Greater re" />
        <link href="https://i1.code.msdn.s-msft.com/RequestReduceContent/c82dc8ab865be0fb7316b2e09ac97654-bafb67d64bd55a2b1fd123070a82b424-RequestReducedStyle.css" rel="Stylesheet" type="text/css" />        
        <script src="https://ajax.aspnetcdn.com/ajax/jquery/jquery-1.6.1.min.js" type="text/javascript" ></script>
        <script src="https://i1.code.msdn.s-msft.com/RequestReduceContent/a12c72272a8fe142a00d8aae0ff5525e-cf9957f54e208c66abb738158989dd84-RequestReducedScript.js" type="text/javascript" ></script>                        <script type="text/javascript">
            function initializePage() {
                var activeTabData = 'activeTab';
                var otherTabClass = 'otherTab';
                var hiddenPreClass = 'hidden';
                $("a[href^=#]").attr("target","_self");
                $("div.scriptcode").each(function (i) {
                    var scriptBlock = $(this);
                    scriptBlock.trackCopy(trackCodeSnippetCodeDownload);
                    var labelElems = scriptBlock.find("div.title > span");
                    if (labelElems.length == 0) {
                        labelElems = scriptBlock.find("div.title");
                    }
                    var languageSpans = scriptBlock.find("span.hidden");
                    var pres = scriptBlock.find("pre");
                    if (languageSpans.length > 0 && pres.length > 1) {
                        labelElems.each(function(index, elem) {
                            var codePre = $(pres[index]);
                            var labelSpan = $(elem);
                            var languageSpan = $(languageSpans[index]);
                            labelSpan.data('code', codePre.text().replace(/(\r(\n)?)|((\r)?\n)/ig, '\r\n'));
                            codePre.removeClass(hiddenPreClass);  
                            codePre.addClass(languageSpan.text().replace(/^\s+|\s+$/g,""));
                            codePre.chili();
                            languageSpan.remove();
                        });

                        pres = scriptBlock.find("pre");
                        labelElems.each(function(index, elem) {
                            var codePre = $(pres[index]);
                            var labelSpan = $(elem);
                            if (index == 0) {
                                scriptBlock.data(activeTabData, 0);
                            }
                            else {
                                labelSpan.addClass(otherTabClass);
                                codePre.addClass(hiddenPreClass);  
                            }
                            labelSpan.click(function (e) {
                                var activeTab = scriptBlock.data(activeTabData);
                                $(labelElems[activeTab]).addClass(otherTabClass);   
                                $(pres[activeTab]).addClass(hiddenPreClass);   
                                        
                                codePre.removeClass(hiddenPreClass);    
                                labelSpan.removeClass(otherTabClass);
                                scriptBlock.data(activeTabData, index);

                                if( window.parent.Galleries ) {
                                    window.parent.Galleries.project.resizeDesc();
                                }
                            });
                        });

                        var preview = scriptBlock.find('div.preview');
                        if (preview.length == 0) {
                            preview = $(pres[pres.length - 1]);
                        }
                        preview.remove();

                        if (window.clipboardData && clipboardData.setData) {
                            var copyLink = $("<a href='#' class='copyCode'>Copy code</a>");
                            copyLink.click(function (e) {
                                trackCodeSnippetCodeDownload();
                                clipboardData.setData("Text", $(labelElems[scriptBlock.data(activeTabData)]).data('code'));
                                return false;
                            });
                            $(this).prepend(copyLink);
                        }
                    }
                });

                if ((window.parent) && (window.parent.Galleries)) {
                    window.parent.Galleries.project.resizeDesc();
                }

                    if (top.location == self.location) {
                         window.location.replace(window.location.href.replace('/description', ''));
                    }
            }

            function trackCodeSnippetCodeDownload() {
                if ((window.parent) && (window.parent.gTracker)) {
                    window.parent.gTracker.createActionEvent('Description', 'Download', 'Copy', 'CodeSnippet', null);
                }
            }
            
            function overrideAnchorLinksForFirefoxAndChrome(iframeId) {
                if(($.browser.mozilla && parseInt($.browser.version, 10) >= 2) || $.browser.webkit) {
                    var iframeOffset = $("#" + iframeId, window.parent.document).offset();
                    $("a").each(function () {
                        var link = $(this);
                        var href = link.attr("href");
                        if (href && href[0] == "#") {
                            var name = href.substring(1);
                            $(this).click(function () {
                                var nameElement = $("[name='" + name + "']");
                                var idElement = $("#" + name);
                                var element = null;
                                if (nameElement.length > 0) {
                                    element = nameElement;
                                } else if (idElement.length > 0) {
                                    element = idElement;
                                }

                                if (element) {
                                    var offset = element.offset();
                                    window.parent.scrollTo(offset.left, offset.top + iframeOffset.top);
                                }

                                return false;
                            });
                        }
                    });
                }
            }

            $(window).load(function(){
                initializePage();
                overrideAnchorLinksForFirefoxAndChrome("longdescIframe");

            });

        </script>
        <base target="_parent" />
    </head>
    <body>
        <div id="longDesc">
            
<pre><span style="font-size:small"><p style="text-align:left"><span style="color:#993366">A PowerShell script to list all installed Microsoft Windows Updates.</span></p><p style="text-align:left"><strong style="font-size:10px"><span style="text-decoration:underline">Script Updated:</span></strong></p><p style="text-align:left"><strong style="font-size:10px"><span style="text-decoration:underline">17/12/2014: </span></strong><strong style="font-size:10px">If command '</strong><strong style="font-size:10px">wmic qfe list' returns $null or '' then use 'Monday 1 January 0001' as date.</strong></p><p style="text-align:left"><strong style="font-size:10px"><span style="text-decoration:underline">Find me on LinkedIN:&nbsp;</span></strong></p></span></pre>
<pre><span><p style="text-align:left"><a class="view-public-profile" title="View public profile" name="webProfileURL" href="http://nz.linkedin.com/pub/topaz-paul/19/275/328/">nz.linkedin.com/pub/topaz-paul/19/275/328/</a></p></span></pre>
<p><strong><span style="color:#993300">PowerShell Version 2 or Greater required.</span></strong></p>
<p><strong>Why use this script?</strong></p>
<p><span>The PowerShell cmdlet 'get-hotfix' sometimes does not draw-out 'installedon' information. win32-Quickfixengineering class does not have that information either. &lt;SIGH&gt;</span></p>
<p><span><br>
</span></p>
<p><strong>What does this script offer?</strong></p>
<p><span>The above void can be filled by using the good old 'wmic qfe list' command. But, the output of the legacy command is mere text and cannot be easily interrogated like objects in PowerShell.&nbsp;</span></p>
<p><span>The attached script converts the output string of&nbsp;'wmic qfe list' command into versatile PowerShell objects, which can be used within other scripts.</span></p>
<p>&nbsp;</p>
<p><span><strong>Note:</strong> Do not forget to include the attached powershell script.</span></p>
<p>&nbsp;</p>
<p><span>The below POSH oneliner lists all updates installed in the last 2 days and tabulates properties:&nbsp;Computername, KBArticle,InstalledOn, HotFixID and InstalledBy.</span></p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>PowerShell</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">powershell</span>
<pre class="hidden">Get-MSHotfix|Where-Object {$_.Installedon -gt ((Get-Date).Adddays(-2))}|Select-Object -Property Computername, KBArticle,InstalledOn, HotFixID, InstalledBy|Format-Table</pre>
<div class="preview">
<pre class="powershell">Get<span class="powerShell__operator">-</span>MSHotfix<span class="powerShell__operator">|</span>Where<span class="powerShell__operator">-</span>Object&nbsp;{<span class="powerShell__variable">$_</span>.Installedon&nbsp;<span class="powerShell__operator">-</span>gt&nbsp;((<span class="powerShell__cmdlets">Get-Date</span>).Adddays(<span class="powerShell__operator">-</span>2))}<span class="powerShell__operator">|</span><span class="powerShell__cmdlets">Select-Object</span>&nbsp;<span class="powerShell__operator">-</span>Property&nbsp;Computername,&nbsp;KBArticle,InstalledOn,&nbsp;HotFixID,&nbsp;InstalledBy<span class="powerShell__operator">|</span><span class="powerShell__cmdlets">Format-Table</span></pre>
</div>
</div>
</div>
<div class="endscriptcode"><img id="130881" src="E:\Documents\WindowsPowerShell\Scripts\PowerShell-script-to-list-0955fe87\Documentation_files\tmp486BResources.png" alt="" width="700"></div>
<div class="endscriptcode"></div>
<div class="endscriptcode"></div>
<div class="endscriptcode"></div>
<div class="endscriptcode">The below powershell command-line will output details about the hotfix with ID&nbsp;'2953522'.</div>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>PowerShell</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">powershell</span>
<pre class="hidden">Get-MSHotfix|Where-Object {$_.HotfixID -match &quot;KB2953522&quot;}</pre>
<div class="preview">
<pre class="powershell">Get<span class="powerShell__operator">-</span>MSHotfix<span class="powerShell__operator">|</span>Where<span class="powerShell__operator">-</span>Object&nbsp;{<span class="powerShell__variable">$_</span>.HotfixID&nbsp;<span class="powerShell__operator">-</span>match&nbsp;<span class="powerShell__string">&quot;KB2953522&quot;</span>}</pre>
</div>
</div>
</div>
<div class="endscriptcode">&nbsp;The below POSH gem opens the Knowledge Base webpage for the&nbsp;hotfix with ID&nbsp;'2953522'.
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>PowerShell</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">powershell</span>
<pre class="hidden">Get-MSHotfix|Where-Object {$_.HotfixID -match &quot;KB2953522&quot;}|ForEach-Object {[System.Diagnostics.Process]::Start($_.KBArticle)}</pre>
<div class="preview">
<pre class="powershell">Get<span class="powerShell__operator">-</span>MSHotfix<span class="powerShell__operator">|</span>Where<span class="powerShell__operator">-</span>Object&nbsp;{<span class="powerShell__variable">$_</span>.HotfixID&nbsp;<span class="powerShell__operator">-</span>match&nbsp;<span class="powerShell__string">&quot;KB2953522&quot;</span>}<span class="powerShell__operator">|</span><span class="powerShell__keyword">ForEach</span><span class="powerShell__operator">-</span>Object&nbsp;{[System.Diagnostics.<span class="powerShell__keyword">Process</span>]::Start(<span class="powerShell__variable">$_</span>.KBArticle)}</pre>
</div>
</div>
</div>
<div class="endscriptcode"><strong>&nbsp;Script content:</strong></div>
</div>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>PowerShell</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">powershell</span>
<pre class="hidden">Function Get-MSHotfix
{
    $outputs = Invoke-Expression &quot;wmic qfe list&quot;
    $outputs = $outputs[1..($outputs.length)]
    
    
    foreach ($output in $Outputs) {
        if ($output) {
            $output = $output -replace 'y U','y-U'
            $output = $output -replace 'NT A','NT-A'
            $output = $output -replace '\s&#43;',' '
            $parts = $output -split ' '
            if ($parts[5] -like &quot;*/*/*&quot;) {
                $Dateis = [datetime]::ParseExact($parts[5], '%M/%d/yyyy',[Globalization.cultureinfo]::GetCultureInfo(&quot;en-US&quot;).DateTimeFormat)
            } else {
                $Dateis = get-date([DateTime][Convert]::ToInt64(&quot;$parts[5]&quot;, 16))-Format '%M/%d/yyyy'
            }
            New-Object -Type PSObject -Property @{
                KBArticle = [string]$parts[0]
                Computername = [string]$parts[1]
                Description = [string]$parts[2]
                FixComments = [string]$parts[6]
                HotFixID = [string]$parts[3]
                InstalledOn = Get-Date($Dateis)-format &quot;dddd d MMMM yyyy&quot;
                InstalledBy = [string]$parts[4]
                InstallDate = [string]$parts[7]
                Name = [string]$parts[8]
                ServicePackInEffect = [string]$parts[9]
                Status = [string]$parts[10]
            }
        }
    }
}
</pre>
<div class="preview">
<pre class="powershell"><span class="powerShell__keyword">Function</span>&nbsp;Get<span class="powerShell__operator">-</span>MSHotfix&nbsp;
{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__variable">$outputs</span>&nbsp;=&nbsp;<span class="powerShell__cmdlets">Invoke-Expression</span>&nbsp;<span class="powerShell__string">&quot;wmic&nbsp;qfe&nbsp;list&quot;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__variable">$outputs</span>&nbsp;=&nbsp;<span class="powerShell__variable">$outputs</span>[1..(<span class="powerShell__variable">$outputs</span>.length)]&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__keyword">foreach</span>&nbsp;(<span class="powerShell__variable">$output</span>&nbsp;<span class="powerShell__keyword">in</span>&nbsp;<span class="powerShell__variable">$Outputs</span>)&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__keyword">if</span>&nbsp;(<span class="powerShell__variable">$output</span>)&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__variable">$output</span>&nbsp;=&nbsp;<span class="powerShell__variable">$output</span>&nbsp;<span class="powerShell__operator">-</span>replace&nbsp;<span class="powerShell__string">'y&nbsp;U'</span>,<span class="powerShell__string">'y-U'</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__variable">$output</span>&nbsp;=&nbsp;<span class="powerShell__variable">$output</span>&nbsp;<span class="powerShell__operator">-</span>replace&nbsp;<span class="powerShell__string">'NT&nbsp;A'</span>,<span class="powerShell__string">'NT-A'</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__variable">$output</span>&nbsp;=&nbsp;<span class="powerShell__variable">$output</span>&nbsp;<span class="powerShell__operator">-</span>replace&nbsp;<span class="powerShell__string">'\s&#43;'</span>,<span class="powerShell__string">'&nbsp;'</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__variable">$parts</span>&nbsp;=&nbsp;<span class="powerShell__variable">$output</span>&nbsp;<span class="powerShell__operator">-</span>split&nbsp;<span class="powerShell__string">'&nbsp;'</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__keyword">if</span>&nbsp;(<span class="powerShell__variable">$parts</span>[5]&nbsp;<span class="powerShell__operator">-</span>like&nbsp;<span class="powerShell__string">&quot;*/*/*&quot;</span>)&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__variable">$Dateis</span>&nbsp;=&nbsp;[datetime]::ParseExact(<span class="powerShell__variable">$parts</span>[5],&nbsp;<span class="powerShell__string">'%M/%d/yyyy'</span>,[Globalization.cultureinfo]::GetCultureInfo(<span class="powerShell__string">&quot;en-US&quot;</span>).DateTimeFormat)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;<span class="powerShell__keyword">else</span>&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__variable">$Dateis</span>&nbsp;=&nbsp;<span class="powerShell__cmdlets">get-date</span>([DateTime][Convert]::ToInt64(<span class="powerShell__string">&quot;$parts[5]&quot;</span>,&nbsp;16))<span class="powerShell__operator">-</span>Format&nbsp;<span class="powerShell__string">'%M/%d/yyyy'</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="powerShell__cmdlets">New-Object</span>&nbsp;<span class="powerShell__operator">-</span><span class="powerShell__alias">Type</span>&nbsp;PSObject&nbsp;<span class="powerShell__operator">-</span>Property&nbsp;@{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KBArticle&nbsp;=&nbsp;[string]<span class="powerShell__variable">$parts</span>[0]&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Computername&nbsp;=&nbsp;[string]<span class="powerShell__variable">$parts</span>[1]&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Description&nbsp;=&nbsp;[string]<span class="powerShell__variable">$parts</span>[2]&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FixComments&nbsp;=&nbsp;[string]<span class="powerShell__variable">$parts</span>[6]&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HotFixID&nbsp;=&nbsp;[string]<span class="powerShell__variable">$parts</span>[3]&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InstalledOn&nbsp;=&nbsp;<span class="powerShell__cmdlets">Get-Date</span>(<span class="powerShell__variable">$Dateis</span>)<span class="powerShell__operator">-</span>format&nbsp;<span class="powerShell__string">&quot;dddd&nbsp;d&nbsp;MMMM&nbsp;yyyy&quot;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InstalledBy&nbsp;=&nbsp;[string]<span class="powerShell__variable">$parts</span>[4]&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InstallDate&nbsp;=&nbsp;[string]<span class="powerShell__variable">$parts</span>[7]&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Name&nbsp;=&nbsp;[string]<span class="powerShell__variable">$parts</span>[8]&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ServicePackInEffect&nbsp;=&nbsp;[string]<span class="powerShell__variable">$parts</span>[9]&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Status&nbsp;=&nbsp;[string]<span class="powerShell__variable">$parts</span>[10]&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
}&nbsp;
</pre>
</div>
</div>
</div>
<p>The following script can be used as a template to run this function against multiple machines.&nbsp;For this to work you have to enable PSRemoting on all the machines.</p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>PowerShell</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">powershell</span>
<pre class="hidden">$scriptDirectory = Split-Path -Parent $MyInvocation.MyCommand.Definition
.&quot;$scriptDirectory\Get-MSHotfix.ps1&quot;
$allUpdates = ''
$array = @(&quot;host1&quot;, &quot;host2&quot;, &quot;host3&quot;)
for ($i=0; $i -lt $array.length; $i&#43;&#43;) {
$Updates = Invoke-Command -ComputerName $array[$i] ${function:Get-MSHotfix}|ft -HideTableHeaders
$allUpdates &#43;= $Updates
}
$allUpdates</pre>
<div class="preview">
<pre class="powershell"><span class="powerShell__variable">$scriptDirectory</span>&nbsp;=&nbsp;<span class="powerShell__cmdlets">Split-Path</span>&nbsp;<span class="powerShell__operator">-</span>Parent&nbsp;<span class="powerShell__variable">$MyInvocation</span>.MyCommand.Definition&nbsp;
.<span class="powerShell__string">&quot;$scriptDirectory\Get-MSHotfix.ps1&quot;</span>&nbsp;
<span class="powerShell__variable">$allUpdates</span>&nbsp;=&nbsp;<span class="powerShell__string">''</span>&nbsp;
<span class="powerShell__variable">$array</span>&nbsp;=&nbsp;@(<span class="powerShell__string">&quot;host1&quot;</span>,&nbsp;<span class="powerShell__string">&quot;host2&quot;</span>,&nbsp;<span class="powerShell__string">&quot;host3&quot;</span>)&nbsp;
<span class="powerShell__keyword">for</span>&nbsp;(<span class="powerShell__variable">$i</span>=0;&nbsp;<span class="powerShell__variable">$i</span>&nbsp;<span class="powerShell__operator">-</span>lt&nbsp;<span class="powerShell__variable">$array</span>.length;&nbsp;<span class="powerShell__variable">$i</span><span class="powerShell__operator">&#43;</span><span class="powerShell__operator">&#43;</span>)&nbsp;{&nbsp;
<span class="powerShell__variable">$Updates</span>&nbsp;=&nbsp;Invoke<span class="powerShell__operator">-</span>Command&nbsp;<span class="powerShell__operator">-</span>ComputerName&nbsp;<span class="powerShell__variable">$array</span>[<span class="powerShell__variable">$i</span>]&nbsp;<span class="powerShell__variable">$</span>{<span class="powerShell__keyword">function</span>:Get<span class="powerShell__operator">-</span>MSHotfix}<span class="powerShell__operator">|</span><span class="powerShell__alias">ft</span>&nbsp;<span class="powerShell__operator">-</span>HideTableHeaders&nbsp;
<span class="powerShell__variable">$allUpdates</span>&nbsp;<span class="powerShell__operator">&#43;</span>=&nbsp;<span class="powerShell__variable">$Updates</span>&nbsp;
}&nbsp;
<span class="powerShell__variable">$allUpdates</span></pre>
</div>
</div>
</div>
<h3 class="endscriptcode">Further notes:</h3>
<div class="endscriptcode"></div>
<div class="endscriptcode">As mentioned above the get-hotfix cmdlet and get-wmiobject -class win32_quickfixengineering command does not output the 'installedon' date for some updates. The reason for which I'm yet to find out.&nbsp;</div>
<div class="endscriptcode"></div>
<div class="endscriptcode"></div>
<h4 class="endscriptcode">Output of the '<em>get-wmiobject -class win32_quickfixengineering</em>' command: InstalledOn&nbsp;<span style="font-size:1em">property
<span style="text-decoration:underline">NOT </span>available for all updates.</span></h4>
<div class="endscriptcode"></div>
<div class="endscriptcode"></div>
<div class="endscriptcode"><img id="120378" src="E:\Documents\WindowsPowerShell\Scripts\PowerShell-script-to-list-0955fe87\Documentation_files\tmp486CResources.png" alt="" width="700"></div>
<div class="endscriptcode"></div>
<div class="endscriptcode"></div>
<h4 class="endscriptcode">Output of the 'wmic&nbsp;qfe list' command: Installedon property available for all updates.</h4>
<div class="endscriptcode"></div>
<div class="endscriptcode"></div>
<div class="endscriptcode"><img id="120379" src="E:\Documents\WindowsPowerShell\Scripts\PowerShell-script-to-list-0955fe87\Documentation_files\tmp486DResources.png" alt="" width="700"></div>
<div class="endscriptcode"></div>
<div class="endscriptcode"></div>
<div class="endscriptcode"></div>
<div class="endscriptcode"><strong>Output of&nbsp;Get-MSHotfix:</strong></div>
<div class="endscriptcode"><span><br>
</span></div>
<div class="endscriptcode"></div>
<div class="endscriptcode"><span><img id="130880" src="E:\Documents\WindowsPowerShell\Scripts\PowerShell-script-to-list-0955fe87\Documentation_files\tmp486EResources.png" alt="" width="700"><br>
</span></div>

        </div>
    </body>
</html>