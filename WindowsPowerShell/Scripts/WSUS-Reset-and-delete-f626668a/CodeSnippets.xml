<?xml version="1.0" encoding="utf-8"?>
<CodeSnippets>
  <Code Content="#  *** THIS SCRIPT IS PROVIDED WITHOUT WARRANTY, USE AT YOUR OWN RISK ***&#xD;&#xA;# Author: David Hall, signalwarrant.com&#xD;&#xA;# This script will allow you to stop the wuauserv service on a client, check to see if the softwaredistribution exists and if so delete it.&#xD;&#xA;# Once the service is stopped and the folder is deleted it restarts the wuauserv service and forces WSUS checkin.&#xD;&#xA;# This is my solution to Windows Update error 8024402C on Windows Server 2008 Servers.&#xD;&#xA;&#xD;&#xA;$path = &quot;c:\windows\SoftwareDistribution&quot;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;# Stopping the wuauserv service&#xD;&#xA;Write-host -foregroundcolor Cyan &quot;1. STOPPING wuauserv service...&quot;&#xD;&#xA;Stop-Service wuauserv  &#xD;&#xA;&#xD;&#xA;# This is just to make sure the wuauserv service has time to stop before moving &#xD;&#xA;# on to the next portion of the script.&#xD;&#xA;[System.Threading.Thread]::Sleep(2500)&#xD;&#xA;&#xD;&#xA;# Testing to see if the c:\windows\SoftwareDistribution folder exists&#xD;&#xA;if (Test-Path $path) {&#xD;&#xA;    &#xD;&#xA;    # If the folder exists Delete it and restart the wuauserv service,&#xD;&#xA;    # force WSUS checkin and exit&#xD;&#xA;    Write-host -foregroundcolor Red &quot;2. SoftwareDistribution Folder Exists... Deleting&quot;&#xD;&#xA;    [System.Threading.Thread]::Sleep(1500)&#xD;&#xA;    Remove-Item -path $path -recurse&#xD;&#xA;    Write-host -foregroundcolor Red &quot;3. *** DELETED ***&quot;&#xD;&#xA;    [System.Threading.Thread]::Sleep(1500)&#xD;&#xA;    Write-host -foregroundcolor Cyan &quot;4. STARTING wuauserv service...&quot;&#xD;&#xA;    Start-Service wuauserv &#xD;&#xA;    [System.Threading.Thread]::Sleep(2500)&#xD;&#xA;    Write-host -foregroundcolor Cyan &quot;5. Forcing WSUS Checkin&quot;&#xD;&#xA;    [System.Threading.Thread]::Sleep(1500)&#xD;&#xA;    Invoke-Command {wuauclt.exe /detectnow}&#xD;&#xA;    Write-host -foregroundcolor Cyan &quot;6. Checkin Complete&quot;&#xD;&#xA;    Exit&#xD;&#xA;    &#xD;&#xA;    } else {&#xD;&#xA;    &#xD;&#xA;    # If the folder does not exist restart the wuauserv service,&#xD;&#xA;    # force WSUS checkin and exit&#xD;&#xA;    Write-host -foregroundcolor Red &quot;2. SoftwareDistribution Folder does not exists, STARTING wuauserv&quot;&#xD;&#xA;    [System.Threading.Thread]::Sleep(1500)&#xD;&#xA;    Write-host -foregroundcolor Cyan &quot;3. STARTING wuauserv service...&quot;&#xD;&#xA;    Start-Service wuauserv&#xD;&#xA;    [System.Threading.Thread]::Sleep(2500)&#xD;&#xA;    Write-host -foregroundcolor Cyan &quot;4. Forcing WSUS Checkin&quot;&#xD;&#xA;    [System.Threading.Thread]::Sleep(1500)&#xD;&#xA;    Invoke-Command {wuauclt.exe /detectnow}&#xD;&#xA;    Write-host -foregroundcolor Cyan &quot;5. Checkin Complete&quot;&#xD;&#xA;    Exit&#xD;&#xA;    }" />
  <Code Content="#  *** THIS SCRIPT IS PROVIDED WITHOUT WARRANTY, USE AT YOUR OWN RISK ***&#xD;&#xA;# Author: David Hall, signalwarrant.com&#xD;&#xA;# This script will allow you to stop the wuauserv service on a client, check to see if the softwaredistribution exists and if so delete it.&#xD;&#xA;# Once the service is stopped and the folder is deleted it restarts the wuauserv service and forces WSUS checkin.&#xD;&#xA;# This is my solution to Windows Update error 8024402C on Windows Server 2008 Servers.&#xD;&#xA;&#xD;&#xA;$path = &quot;c:\windows\SoftwareDistribution&quot;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;# Stopping the wuauserv service&#xD;&#xA;Write-host -foregroundcolor Cyan &quot;1. STOPPING wuauserv service...&quot;&#xD;&#xA;Stop-Service wuauserv  &#xD;&#xA;&#xD;&#xA;# This is just to make sure the wuauserv service has time to stop before moving &#xD;&#xA;# on to the next portion of the script.&#xD;&#xA;[System.Threading.Thread]::Sleep(2500)&#xD;&#xA;&#xD;&#xA;# Testing to see if the c:\windows\SoftwareDistribution folder exists&#xD;&#xA;if (Test-Path $path) {&#xD;&#xA;    &#xD;&#xA;    # If the folder exists Delete it and restart the wuauserv service,&#xD;&#xA;    # force WSUS checkin and exit&#xD;&#xA;    Write-host -foregroundcolor Red &quot;2. SoftwareDistribution Folder Exists... Deleting&quot;&#xD;&#xA;    [System.Threading.Thread]::Sleep(1500)&#xD;&#xA;    Remove-Item -path $path -recurse&#xD;&#xA;    Write-host -foregroundcolor Red &quot;3. *** DELETED ***&quot;&#xD;&#xA;    [System.Threading.Thread]::Sleep(1500)&#xD;&#xA;    Write-host -foregroundcolor Cyan &quot;4. STARTING wuauserv service...&quot;&#xD;&#xA;    Start-Service wuauserv &#xD;&#xA;    [System.Threading.Thread]::Sleep(2500)&#xD;&#xA;    Write-host -foregroundcolor Cyan &quot;5. Forcing WSUS Checkin&quot;&#xD;&#xA;    [System.Threading.Thread]::Sleep(1500)&#xD;&#xA;    Invoke-Command {wuauclt.exe /detectnow}&#xD;&#xA;    Write-host -foregroundcolor Cyan &quot;6. Checkin Complete&quot;&#xD;&#xA;    Exit&#xD;&#xA;    &#xD;&#xA;    } else {&#xD;&#xA;    &#xD;&#xA;    # If the folder does not exist restart the wuauserv service,&#xD;&#xA;    # force WSUS checkin and exit&#xD;&#xA;    Write-host -foregroundcolor Red &quot;2. SoftwareDistribution Folder does not exists, STARTING wuauserv&quot;&#xD;&#xA;    [System.Threading.Thread]::Sleep(1500)&#xD;&#xA;    Write-host -foregroundcolor Cyan &quot;3. STARTING wuauserv service...&quot;&#xD;&#xA;    Start-Service wuauserv&#xD;&#xA;    [System.Threading.Thread]::Sleep(2500)&#xD;&#xA;    Write-host -foregroundcolor Cyan &quot;4. Forcing WSUS Checkin&quot;&#xD;&#xA;    [System.Threading.Thread]::Sleep(1500)&#xD;&#xA;    Invoke-Command {wuauclt.exe /detectnow}&#xD;&#xA;    Write-host -foregroundcolor Cyan &quot;5. Checkin Complete&quot;&#xD;&#xA;    Exit&#xD;&#xA;    }" />
</CodeSnippets>