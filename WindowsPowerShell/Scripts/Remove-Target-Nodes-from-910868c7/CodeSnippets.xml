<?xml version="1.0" encoding="utf-8"?>
<CodeSnippets>
  <Code Content="&lt;#&#xD;&#xA;.SYNOPSIS Remove all servers from specified WSUS group.&#xD;&#xA;.NOTES Please define WSUS server and WSUS Group for which to remove nodes.&#xD;&#xA;#&gt;&#xD;&#xA;&#xD;&#xA;Clear-Host&#xD;&#xA;&#xD;&#xA;$varWSUSServer = &quot;WSUSServer&quot;&#xD;&#xA;$varWSUSGroup = &quot;Patch Group Week 1&quot;&#xD;&#xA;$varLogFile = &quot;LOG-Remove-SystemsByWSUSGroup-$($env:computername).log&quot;&#xD;&#xA;&#xD;&#xA;Function LogWrite&#xD;&#xA;{&#xD;&#xA;  Param ([string]$logstring)&#xD;&#xA;  Add-Content $varLogFile -value $logstring&#xD;&#xA;  Write-Host $logstring&#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;LogWrite &quot;`n$(get-date -f u)`t--- START ---&quot;&#xD;&#xA;LogWrite &quot;$(get-date -f u)`tExecuting Remove-SystemsByWSUSGroup.ps1 on $($env:computername) by user $($env:USERNAME)&quot;&#xD;&#xA;&#xD;&#xA;LogWrite &quot;$(get-date -f u)`tConnecting to WSUS system $($varWSUSServer).&quot;&#xD;&#xA;[void][reflection.assembly]::LoadWithPartialName(&quot;Microsoft.UpdateServices.Administration&quot;)&#xD;&#xA;$varWSUS = [Microsoft.UpdateServices.Administration.AdminProxy]::getUpdateServer($varWSUSServer,$False)&#xD;&#xA;&#xD;&#xA;LogWrite &quot;$(get-date -f u)`tSearching WSUS for systems in $($varWSUSGroup) group.&quot;&#xD;&#xA;$varNodeTargets = ($varWSUS.GetComputerTargetGroups() | Where { $_.Name -eq $varWSUSGroup }).GetComputerTargets()&#xD;&#xA;&#xD;&#xA;LogWrite &quot;$(get-date -f u)`tConnecting to appropiate WSUS groups.&quot;&#xD;&#xA;$varWSUSTargetGroup = $varWSUS.GetComputerTargetGroups() | ? {$_.Name -eq $varWSUSGroup }&#xD;&#xA;&#xD;&#xA;LogWrite &quot;$(get-date -f u)`t Begining to work through discovered array of target nodes...&quot;&#xD;&#xA;$varNodeTargets | foreach-object {&#xD;&#xA;    LogWrite &quot;$(get-date -f u)`t &gt; Removing $($_.FullDomainName) from $($varWSUSGroup) group.&quot;&#xD;&#xA;    $varWSUSTargetGroup.RemoveComputerTarget($_)&#xD;&#xA;    # Alternatively you could add the nodes instead...&#xD;&#xA;    #$varWSUSTargetGroup.AddComputerTarget($_)&#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;LogWrite &quot;$(get-date -f u)`t--- END ---&quot;" />
</CodeSnippets>